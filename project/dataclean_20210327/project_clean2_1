{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# import package"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 543,
   "metadata": {},
   "outputs": [],
   "source": [
    "import re\n",
    "import csv\n",
    "import numpy as np\n",
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## data extract"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 544,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>loc</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location: Bay of PlentyBay of Plentyarea: Taur...</td>\n",
       "      <td>Featured,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>location: Bay of PlentyBay of Plentyarea: Taur...</td>\n",
       "      <td>Featured,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>location: AucklandAuckland</td>\n",
       "      <td>4d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>location: SouthlandSouthlandarea: Invercargill...</td>\n",
       "      <td>1h ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location: CanterburyCanterburyarea: Christchur...</td>\n",
       "      <td>4d ago,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   role  \\\n",
       "0                         Administrator   \n",
       "1                          Receptionist   \n",
       "2          Prosecutions Support Officer   \n",
       "3  Early Childhood Centre Administrator   \n",
       "4        Business Support Administrator   \n",
       "\n",
       "                                        website_link  \\\n",
       "0  https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1  https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2  https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3  https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4  https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "\n",
       "                                    company  \\\n",
       "0                                       NaN   \n",
       "1                      Avenues Orthodontics   \n",
       "2                        New Zealand Police   \n",
       "3  Kew Pacific Island Early Learning Centre   \n",
       "4                                       NaN   \n",
       "\n",
       "                                                 loc  \\\n",
       "0  location: Bay of PlentyBay of Plentyarea: Taur...   \n",
       "1  location: Bay of PlentyBay of Plentyarea: Taur...   \n",
       "2                         location: AucklandAuckland   \n",
       "3  location: SouthlandSouthlandarea: Invercargill...   \n",
       "4  location: CanterburyCanterburyarea: Christchur...   \n",
       "\n",
       "                         post_day  \\\n",
       "0  Featured,at,Private Advertiser   \n",
       "1                     Featured,at   \n",
       "2                       4d ago,at   \n",
       "3                       1h ago,at   \n",
       "4    4d ago,at,Private Advertiser   \n",
       "\n",
       "                                      classification  \n",
       "0  classification: Administration & Office Suppor...  \n",
       "1  classification: Administration & Office Suppor...  \n",
       "2  classification: Administration & Office Suppor...  \n",
       "3  classification: Administration & Office Suppor...  \n",
       "4  classification: Administration & Office Suppor...  "
      ]
     },
     "execution_count": 544,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#read_data\n",
    "csv_files = pd.read_csv(\"/Users/wangzhuoxin/Desktop/NZ_Admin_JOBS.csv\")\n",
    "csv_files.head()\n",
    "\n",
    "# change head name \n",
    "#df_new = df.rename(columns={'A': 'a'}, index={'ONE': 'one'})\n",
    "csv_new = csv_files.rename(columns = {\"字段1\": \"role\",\"字段1_link\": \"website_link\", \"字段2\":\"company\", \"字段3\":\"loc\",\"字段4\": 'post_day',\"字段5\":\"classification\"})\n",
    "csv_new.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## check data types"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 545,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 2708 entries, 0 to 2707\n",
      "Data columns (total 6 columns):\n",
      "role              2708 non-null object\n",
      "website_link      2708 non-null object\n",
      "company           2686 non-null object\n",
      "loc               2708 non-null object\n",
      "post_day          2708 non-null object\n",
      "classification    2708 non-null object\n",
      "dtypes: object(6)\n",
      "memory usage: 127.1+ KB\n"
     ]
    }
   ],
   "source": [
    "csv_new.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## get rid of \"location:\" in the loc column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 546,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['location'] = csv_new['loc'].apply(lambda x:x[9:])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 547,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0     Bay of PlentyBay of Plentyarea: TaurangaTauranga\n",
       "1     Bay of PlentyBay of Plentyarea: TaurangaTauranga\n",
       "2                                     AucklandAuckland\n",
       "3     SouthlandSouthlandarea: InvercargillInvercargill\n",
       "4     CanterburyCanterburyarea: ChristchurchChristc...\n",
       "Name: location, dtype: object"
      ]
     },
     "execution_count": 547,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new['location'].head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 548,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>loc</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location: Bay of PlentyBay of Plentyarea: Taur...</td>\n",
       "      <td>Featured,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Bay of PlentyBay of Plentyarea: TaurangaTauranga</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>location: Bay of PlentyBay of Plentyarea: Taur...</td>\n",
       "      <td>Featured,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Bay of PlentyBay of Plentyarea: TaurangaTauranga</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>location: AucklandAuckland</td>\n",
       "      <td>4d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>AucklandAuckland</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>location: SouthlandSouthlandarea: Invercargill...</td>\n",
       "      <td>1h ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>SouthlandSouthlandarea: InvercargillInvercargill</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location: CanterburyCanterburyarea: Christchur...</td>\n",
       "      <td>4d ago,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>CanterburyCanterburyarea: ChristchurchChristc...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   role  \\\n",
       "0                         Administrator   \n",
       "1                          Receptionist   \n",
       "2          Prosecutions Support Officer   \n",
       "3  Early Childhood Centre Administrator   \n",
       "4        Business Support Administrator   \n",
       "\n",
       "                                        website_link  \\\n",
       "0  https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1  https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2  https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3  https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4  https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "\n",
       "                                    company  \\\n",
       "0                                       NaN   \n",
       "1                      Avenues Orthodontics   \n",
       "2                        New Zealand Police   \n",
       "3  Kew Pacific Island Early Learning Centre   \n",
       "4                                       NaN   \n",
       "\n",
       "                                                 loc  \\\n",
       "0  location: Bay of PlentyBay of Plentyarea: Taur...   \n",
       "1  location: Bay of PlentyBay of Plentyarea: Taur...   \n",
       "2                         location: AucklandAuckland   \n",
       "3  location: SouthlandSouthlandarea: Invercargill...   \n",
       "4  location: CanterburyCanterburyarea: Christchur...   \n",
       "\n",
       "                         post_day  \\\n",
       "0  Featured,at,Private Advertiser   \n",
       "1                     Featured,at   \n",
       "2                       4d ago,at   \n",
       "3                       1h ago,at   \n",
       "4    4d ago,at,Private Advertiser   \n",
       "\n",
       "                                      classification  \\\n",
       "0  classification: Administration & Office Suppor...   \n",
       "1  classification: Administration & Office Suppor...   \n",
       "2  classification: Administration & Office Suppor...   \n",
       "3  classification: Administration & Office Suppor...   \n",
       "4  classification: Administration & Office Suppor...   \n",
       "\n",
       "                                            location  \n",
       "0   Bay of PlentyBay of Plentyarea: TaurangaTauranga  \n",
       "1   Bay of PlentyBay of Plentyarea: TaurangaTauranga  \n",
       "2                                   AucklandAuckland  \n",
       "3   SouthlandSouthlandarea: InvercargillInvercargill  \n",
       "4   CanterburyCanterburyarea: ChristchurchChristc...  "
      ]
     },
     "execution_count": 548,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## split location into two column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 549,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new[['area','location']] = csv_new['location'].str.split(': ', expand = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 550,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>loc</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location: Bay of PlentyBay of Plentyarea: Taur...</td>\n",
       "      <td>Featured,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>TaurangaTauranga</td>\n",
       "      <td>Bay of PlentyBay of Plentyarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>location: Bay of PlentyBay of Plentyarea: Taur...</td>\n",
       "      <td>Featured,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>TaurangaTauranga</td>\n",
       "      <td>Bay of PlentyBay of Plentyarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>location: AucklandAuckland</td>\n",
       "      <td>4d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>None</td>\n",
       "      <td>AucklandAuckland</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>location: SouthlandSouthlandarea: Invercargill...</td>\n",
       "      <td>1h ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>InvercargillInvercargill</td>\n",
       "      <td>SouthlandSouthlandarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location: CanterburyCanterburyarea: Christchur...</td>\n",
       "      <td>4d ago,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>ChristchurchChristchurch</td>\n",
       "      <td>CanterburyCanterburyarea</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   role  \\\n",
       "0                         Administrator   \n",
       "1                          Receptionist   \n",
       "2          Prosecutions Support Officer   \n",
       "3  Early Childhood Centre Administrator   \n",
       "4        Business Support Administrator   \n",
       "\n",
       "                                        website_link  \\\n",
       "0  https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1  https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2  https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3  https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4  https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "\n",
       "                                    company  \\\n",
       "0                                       NaN   \n",
       "1                      Avenues Orthodontics   \n",
       "2                        New Zealand Police   \n",
       "3  Kew Pacific Island Early Learning Centre   \n",
       "4                                       NaN   \n",
       "\n",
       "                                                 loc  \\\n",
       "0  location: Bay of PlentyBay of Plentyarea: Taur...   \n",
       "1  location: Bay of PlentyBay of Plentyarea: Taur...   \n",
       "2                         location: AucklandAuckland   \n",
       "3  location: SouthlandSouthlandarea: Invercargill...   \n",
       "4  location: CanterburyCanterburyarea: Christchur...   \n",
       "\n",
       "                         post_day  \\\n",
       "0  Featured,at,Private Advertiser   \n",
       "1                     Featured,at   \n",
       "2                       4d ago,at   \n",
       "3                       1h ago,at   \n",
       "4    4d ago,at,Private Advertiser   \n",
       "\n",
       "                                      classification  \\\n",
       "0  classification: Administration & Office Suppor...   \n",
       "1  classification: Administration & Office Suppor...   \n",
       "2  classification: Administration & Office Suppor...   \n",
       "3  classification: Administration & Office Suppor...   \n",
       "4  classification: Administration & Office Suppor...   \n",
       "\n",
       "                   location                             area  \n",
       "0          TaurangaTauranga   Bay of PlentyBay of Plentyarea  \n",
       "1          TaurangaTauranga   Bay of PlentyBay of Plentyarea  \n",
       "2                      None                 AucklandAuckland  \n",
       "3  InvercargillInvercargill           SouthlandSouthlandarea  \n",
       "4  ChristchurchChristchurch         CanterburyCanterburyarea  "
      ]
     },
     "execution_count": 550,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## clean NA value in the area and loc column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 551,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 551,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new['location'].isna().any()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 552,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['location'].fillna('unknown',inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 553,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['area'].fillna('unknown',inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 554,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 554,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new['location'].isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 555,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>loc</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location: Bay of PlentyBay of Plentyarea: Taur...</td>\n",
       "      <td>Featured,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>TaurangaTauranga</td>\n",
       "      <td>Bay of PlentyBay of Plentyarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>location: Bay of PlentyBay of Plentyarea: Taur...</td>\n",
       "      <td>Featured,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>TaurangaTauranga</td>\n",
       "      <td>Bay of PlentyBay of Plentyarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>location: AucklandAuckland</td>\n",
       "      <td>4d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>AucklandAuckland</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>location: SouthlandSouthlandarea: Invercargill...</td>\n",
       "      <td>1h ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>InvercargillInvercargill</td>\n",
       "      <td>SouthlandSouthlandarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location: CanterburyCanterburyarea: Christchur...</td>\n",
       "      <td>4d ago,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>ChristchurchChristchurch</td>\n",
       "      <td>CanterburyCanterburyarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50640393?type=stand...</td>\n",
       "      <td>Ministry for Primary Industries</td>\n",
       "      <td>location: NorthlandNorthlandarea: WhangareiWha...</td>\n",
       "      <td>9m ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>WhangareiWhangarei</td>\n",
       "      <td>NorthlandNorthlandarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>6</td>\n",
       "      <td>Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50615674?type=stand...</td>\n",
       "      <td>Ministry of Business, Innovation and Employment</td>\n",
       "      <td>location: WellingtonWellingtonarea: Wellington...</td>\n",
       "      <td>5d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Wellington CentralWellington Central</td>\n",
       "      <td>WellingtonWellingtonarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>office administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50640166?type=stand...</td>\n",
       "      <td>Hepburn Electrical Ltd</td>\n",
       "      <td>location: Bay of PlentyBay of Plentyarea: Roto...</td>\n",
       "      <td>7m ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>RotoruaRotorua</td>\n",
       "      <td>Bay of PlentyBay of Plentyarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8</td>\n",
       "      <td>Office Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639248?type=stand...</td>\n",
       "      <td>Webster Holland Ltd</td>\n",
       "      <td>location: Bay of PlentyBay of Plentyarea: Taur...</td>\n",
       "      <td>2h ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>TaurangaTauranga</td>\n",
       "      <td>Bay of PlentyBay of Plentyarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>9</td>\n",
       "      <td>Administration Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50629393?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>location: CanterburyCanterbury</td>\n",
       "      <td>3d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>CanterburyCanterbury</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>10</td>\n",
       "      <td>Administration Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50600186?type=stand...</td>\n",
       "      <td>Department of Conservation</td>\n",
       "      <td>location: West CoastWest Coastarea: Rest of We...</td>\n",
       "      <td>7d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Rest of West CoastRest of West Coast</td>\n",
       "      <td>West CoastWest Coastarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>11</td>\n",
       "      <td>Data Entry</td>\n",
       "      <td>https://www.seek.co.nz/job/50616188?type=stand...</td>\n",
       "      <td>Triple One Care</td>\n",
       "      <td>location: TasmanTasmanarea: NelsonNelson</td>\n",
       "      <td>5d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>NelsonNelson</td>\n",
       "      <td>TasmanTasmanarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>12</td>\n",
       "      <td>Office Admin Assistant (10hrs per week)</td>\n",
       "      <td>https://www.seek.co.nz/job/50597141?type=stand...</td>\n",
       "      <td>UIV Limited - Premier Insulation North Central</td>\n",
       "      <td>location: AucklandAucklandarea: Manukau &amp; East...</td>\n",
       "      <td>8d ago,at</td>\n",
       "      <td>$20 per hour</td>\n",
       "      <td>Manukau &amp; East AucklandManukau &amp; East Auckland...</td>\n",
       "      <td>AucklandAucklandarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>13</td>\n",
       "      <td>Office Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50632818?type=stand...</td>\n",
       "      <td>Wraight and Associates Ltd.</td>\n",
       "      <td>location: WellingtonWellingtonarea: Wellington...</td>\n",
       "      <td>3d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Wellington CentralWellington Central</td>\n",
       "      <td>WellingtonWellingtonarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>14</td>\n",
       "      <td>Office Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50632185?type=stand...</td>\n",
       "      <td>Morgan &amp; Pollard Landscapes Ltd</td>\n",
       "      <td>location: CanterburyCanterburyarea: Rest of Ca...</td>\n",
       "      <td>3d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Rest of CanterburyRest of Canterbury</td>\n",
       "      <td>CanterburyCanterburyarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>15</td>\n",
       "      <td>Customer Service Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50614282?type=stand...</td>\n",
       "      <td>CM Trailer Parts</td>\n",
       "      <td>location: CanterburyCanterburyarea: Timaru &amp; S...</td>\n",
       "      <td>5d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Timaru &amp; South CanterburyTimaru &amp; South Canter...</td>\n",
       "      <td>CanterburyCanterburyarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>16</td>\n",
       "      <td>Administration Assistant - Mt Wellington</td>\n",
       "      <td>https://www.seek.co.nz/job/50638817?type=stand...</td>\n",
       "      <td>Harvey Norman</td>\n",
       "      <td>location: AucklandAucklandarea: Auckland Centr...</td>\n",
       "      <td>4h ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Auckland CentralAuckland Central</td>\n",
       "      <td>AucklandAucklandarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>17</td>\n",
       "      <td>Part-time Health &amp; Disability Administrative A...</td>\n",
       "      <td>https://www.seek.co.nz/job/50610748?type=stand...</td>\n",
       "      <td>LIFEWISE</td>\n",
       "      <td>location: AucklandAucklandarea: Auckland Centr...</td>\n",
       "      <td>6d ago,at</td>\n",
       "      <td>$20 - $24.99 per hour</td>\n",
       "      <td>Auckland CentralAuckland Central,$20 - $24.99 ...</td>\n",
       "      <td>AucklandAucklandarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>18</td>\n",
       "      <td>Office Coordinator, Whangarei Youth Space</td>\n",
       "      <td>https://www.seek.co.nz/job/50633756?type=stand...</td>\n",
       "      <td>Whangarei Youth Space</td>\n",
       "      <td>location: NorthlandNorthlandarea: WhangareiWha...</td>\n",
       "      <td>3d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>WhangareiWhangarei</td>\n",
       "      <td>NorthlandNorthlandarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>19</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50604829?type=stand...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location: ManawatuManawatuarea: Rest of Manawa...</td>\n",
       "      <td>7d ago,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Rest of ManawatuRest of Manawatu</td>\n",
       "      <td>ManawatuManawatuarea</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>20</td>\n",
       "      <td>Administration Officer - Part Time</td>\n",
       "      <td>https://www.seek.co.nz/job/50637525?type=stand...</td>\n",
       "      <td>HiFlo Pumps Ltd</td>\n",
       "      <td>location: AucklandAucklandarea: Auckland Centr...</td>\n",
       "      <td>2d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Auckland CentralAuckland Central</td>\n",
       "      <td>AucklandAucklandarea</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                 role  \\\n",
       "0                                       Administrator   \n",
       "1                                        Receptionist   \n",
       "2                        Prosecutions Support Officer   \n",
       "3                Early Childhood Centre Administrator   \n",
       "4                      Business Support Administrator   \n",
       "5                                     Support Officer   \n",
       "6                                     Support Officer   \n",
       "7                                office administrator   \n",
       "8                                Office Administrator   \n",
       "9                              Administration Officer   \n",
       "10                             Administration Officer   \n",
       "11                                         Data Entry   \n",
       "12            Office Admin Assistant (10hrs per week)   \n",
       "13                               Office Administrator   \n",
       "14                               Office Administrator   \n",
       "15                           Customer Service Officer   \n",
       "16           Administration Assistant - Mt Wellington   \n",
       "17  Part-time Health & Disability Administrative A...   \n",
       "18          Office Coordinator, Whangarei Youth Space   \n",
       "19                                      Administrator   \n",
       "20                 Administration Officer - Part Time   \n",
       "\n",
       "                                         website_link  \\\n",
       "0   https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1   https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2   https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3   https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4   https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "5   https://www.seek.co.nz/job/50640393?type=stand...   \n",
       "6   https://www.seek.co.nz/job/50615674?type=stand...   \n",
       "7   https://www.seek.co.nz/job/50640166?type=stand...   \n",
       "8   https://www.seek.co.nz/job/50639248?type=stand...   \n",
       "9   https://www.seek.co.nz/job/50629393?type=stand...   \n",
       "10  https://www.seek.co.nz/job/50600186?type=stand...   \n",
       "11  https://www.seek.co.nz/job/50616188?type=stand...   \n",
       "12  https://www.seek.co.nz/job/50597141?type=stand...   \n",
       "13  https://www.seek.co.nz/job/50632818?type=stand...   \n",
       "14  https://www.seek.co.nz/job/50632185?type=stand...   \n",
       "15  https://www.seek.co.nz/job/50614282?type=stand...   \n",
       "16  https://www.seek.co.nz/job/50638817?type=stand...   \n",
       "17  https://www.seek.co.nz/job/50610748?type=stand...   \n",
       "18  https://www.seek.co.nz/job/50633756?type=stand...   \n",
       "19  https://www.seek.co.nz/job/50604829?type=stand...   \n",
       "20  https://www.seek.co.nz/job/50637525?type=stand...   \n",
       "\n",
       "                                            company  \\\n",
       "0                                               NaN   \n",
       "1                              Avenues Orthodontics   \n",
       "2                                New Zealand Police   \n",
       "3          Kew Pacific Island Early Learning Centre   \n",
       "4                                               NaN   \n",
       "5                   Ministry for Primary Industries   \n",
       "6   Ministry of Business, Innovation and Employment   \n",
       "7                            Hepburn Electrical Ltd   \n",
       "8                               Webster Holland Ltd   \n",
       "9                                New Zealand Police   \n",
       "10                       Department of Conservation   \n",
       "11                                  Triple One Care   \n",
       "12   UIV Limited - Premier Insulation North Central   \n",
       "13                      Wraight and Associates Ltd.   \n",
       "14                  Morgan & Pollard Landscapes Ltd   \n",
       "15                                 CM Trailer Parts   \n",
       "16                                    Harvey Norman   \n",
       "17                                         LIFEWISE   \n",
       "18                            Whangarei Youth Space   \n",
       "19                                              NaN   \n",
       "20                                  HiFlo Pumps Ltd   \n",
       "\n",
       "                                                  loc  \\\n",
       "0   location: Bay of PlentyBay of Plentyarea: Taur...   \n",
       "1   location: Bay of PlentyBay of Plentyarea: Taur...   \n",
       "2                          location: AucklandAuckland   \n",
       "3   location: SouthlandSouthlandarea: Invercargill...   \n",
       "4   location: CanterburyCanterburyarea: Christchur...   \n",
       "5   location: NorthlandNorthlandarea: WhangareiWha...   \n",
       "6   location: WellingtonWellingtonarea: Wellington...   \n",
       "7   location: Bay of PlentyBay of Plentyarea: Roto...   \n",
       "8   location: Bay of PlentyBay of Plentyarea: Taur...   \n",
       "9                      location: CanterburyCanterbury   \n",
       "10  location: West CoastWest Coastarea: Rest of We...   \n",
       "11           location: TasmanTasmanarea: NelsonNelson   \n",
       "12  location: AucklandAucklandarea: Manukau & East...   \n",
       "13  location: WellingtonWellingtonarea: Wellington...   \n",
       "14  location: CanterburyCanterburyarea: Rest of Ca...   \n",
       "15  location: CanterburyCanterburyarea: Timaru & S...   \n",
       "16  location: AucklandAucklandarea: Auckland Centr...   \n",
       "17  location: AucklandAucklandarea: Auckland Centr...   \n",
       "18  location: NorthlandNorthlandarea: WhangareiWha...   \n",
       "19  location: ManawatuManawatuarea: Rest of Manawa...   \n",
       "20  location: AucklandAucklandarea: Auckland Centr...   \n",
       "\n",
       "                          post_day  \\\n",
       "0   Featured,at,Private Advertiser   \n",
       "1                      Featured,at   \n",
       "2                        4d ago,at   \n",
       "3                        1h ago,at   \n",
       "4     4d ago,at,Private Advertiser   \n",
       "5                        9m ago,at   \n",
       "6                        5d ago,at   \n",
       "7                        7m ago,at   \n",
       "8                        2h ago,at   \n",
       "9                        3d ago,at   \n",
       "10                       7d ago,at   \n",
       "11                       5d ago,at   \n",
       "12                       8d ago,at   \n",
       "13                       3d ago,at   \n",
       "14                       3d ago,at   \n",
       "15                       5d ago,at   \n",
       "16                       4h ago,at   \n",
       "17                       6d ago,at   \n",
       "18                       3d ago,at   \n",
       "19    7d ago,at,Private Advertiser   \n",
       "20                       2d ago,at   \n",
       "\n",
       "                                       classification  \\\n",
       "0   classification: Administration & Office Suppor...   \n",
       "1   classification: Administration & Office Suppor...   \n",
       "2   classification: Administration & Office Suppor...   \n",
       "3   classification: Administration & Office Suppor...   \n",
       "4   classification: Administration & Office Suppor...   \n",
       "5   classification: Administration & Office Suppor...   \n",
       "6   classification: Administration & Office Suppor...   \n",
       "7   classification: Administration & Office Suppor...   \n",
       "8   classification: Administration & Office Suppor...   \n",
       "9   classification: Administration & Office Suppor...   \n",
       "10  classification: Administration & Office Suppor...   \n",
       "11  classification: Administration & Office Suppor...   \n",
       "12                                       $20 per hour   \n",
       "13  classification: Administration & Office Suppor...   \n",
       "14  classification: Administration & Office Suppor...   \n",
       "15  classification: Administration & Office Suppor...   \n",
       "16  classification: Administration & Office Suppor...   \n",
       "17                              $20 - $24.99 per hour   \n",
       "18  classification: Administration & Office Suppor...   \n",
       "19  classification: Administration & Office Suppor...   \n",
       "20  classification: Administration & Office Suppor...   \n",
       "\n",
       "                                             location  \\\n",
       "0                                    TaurangaTauranga   \n",
       "1                                    TaurangaTauranga   \n",
       "2                                             unknown   \n",
       "3                            InvercargillInvercargill   \n",
       "4                            ChristchurchChristchurch   \n",
       "5                                  WhangareiWhangarei   \n",
       "6                Wellington CentralWellington Central   \n",
       "7                                      RotoruaRotorua   \n",
       "8                                    TaurangaTauranga   \n",
       "9                                             unknown   \n",
       "10               Rest of West CoastRest of West Coast   \n",
       "11                                       NelsonNelson   \n",
       "12  Manukau & East AucklandManukau & East Auckland...   \n",
       "13               Wellington CentralWellington Central   \n",
       "14               Rest of CanterburyRest of Canterbury   \n",
       "15  Timaru & South CanterburyTimaru & South Canter...   \n",
       "16                   Auckland CentralAuckland Central   \n",
       "17  Auckland CentralAuckland Central,$20 - $24.99 ...   \n",
       "18                                 WhangareiWhangarei   \n",
       "19                   Rest of ManawatuRest of Manawatu   \n",
       "20                   Auckland CentralAuckland Central   \n",
       "\n",
       "                               area  \n",
       "0    Bay of PlentyBay of Plentyarea  \n",
       "1    Bay of PlentyBay of Plentyarea  \n",
       "2                  AucklandAuckland  \n",
       "3            SouthlandSouthlandarea  \n",
       "4          CanterburyCanterburyarea  \n",
       "5            NorthlandNorthlandarea  \n",
       "6          WellingtonWellingtonarea  \n",
       "7    Bay of PlentyBay of Plentyarea  \n",
       "8    Bay of PlentyBay of Plentyarea  \n",
       "9              CanterburyCanterbury  \n",
       "10         West CoastWest Coastarea  \n",
       "11                 TasmanTasmanarea  \n",
       "12             AucklandAucklandarea  \n",
       "13         WellingtonWellingtonarea  \n",
       "14         CanterburyCanterburyarea  \n",
       "15         CanterburyCanterburyarea  \n",
       "16             AucklandAucklandarea  \n",
       "17             AucklandAucklandarea  \n",
       "18           NorthlandNorthlandarea  \n",
       "19             ManawatuManawatuarea  \n",
       "20             AucklandAucklandarea  "
      ]
     },
     "execution_count": 555,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.head(21)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 556,
   "metadata": {},
   "outputs": [],
   "source": [
    "#eg. abcabc,$23 per hour\n",
    "csv_new['location'] = csv_new['location'].replace('(\\,[\\s\\S]*)',\"\",regex = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 557,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0                           TaurangaTauranga\n",
       "1                           TaurangaTauranga\n",
       "2                                    unknown\n",
       "3                   InvercargillInvercargill\n",
       "4                   ChristchurchChristchurch\n",
       "                        ...                 \n",
       "2703        Auckland CentralAuckland Central\n",
       "2704    Wellington CentralWellington Central\n",
       "2705                        HamiltonHamilton\n",
       "2706                        HamiltonHamilton\n",
       "2707                                 unknown\n",
       "Name: location, Length: 2708, dtype: object"
      ]
     },
     "execution_count": 557,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new['location']"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## clean out the dulplicate value in the area and location collumn"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 558,
   "metadata": {},
   "outputs": [],
   "source": [
    "def dulplicate_loc(a):\n",
    "    mid = len(a)//2\n",
    "    if a == 'unknown':\n",
    "        return 'unknown'\n",
    "    else:\n",
    "        return a[mid:]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 559,
   "metadata": {},
   "outputs": [],
   "source": [
    "def dulplicate_area(a):\n",
    "    mid = len(a)//2\n",
    "    if a == 'unknown':\n",
    "        return 'unknown'\n",
    "    else:\n",
    "        return a[mid+1:]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 560,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['location']= csv_new['location'].apply(dulplicate_loc)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 561,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new[['area','delete1']] = csv_new['area'].str.split('area',expand = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 562,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['area'] = csv_new['area'].apply(dulplicate_area)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 563,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>loc</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>delete1</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location: Bay of PlentyBay of Plentyarea: Taur...</td>\n",
       "      <td>Featured,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>location: Bay of PlentyBay of Plentyarea: Taur...</td>\n",
       "      <td>Featured,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>location: AucklandAuckland</td>\n",
       "      <td>4d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>location: SouthlandSouthlandarea: Invercargill...</td>\n",
       "      <td>1h ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Invercargill</td>\n",
       "      <td>Southland</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>location: CanterburyCanterburyarea: Christchur...</td>\n",
       "      <td>4d ago,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Christchurch</td>\n",
       "      <td>Canterbury</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   role  \\\n",
       "0                         Administrator   \n",
       "1                          Receptionist   \n",
       "2          Prosecutions Support Officer   \n",
       "3  Early Childhood Centre Administrator   \n",
       "4        Business Support Administrator   \n",
       "\n",
       "                                        website_link  \\\n",
       "0  https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1  https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2  https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3  https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4  https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "\n",
       "                                    company  \\\n",
       "0                                       NaN   \n",
       "1                      Avenues Orthodontics   \n",
       "2                        New Zealand Police   \n",
       "3  Kew Pacific Island Early Learning Centre   \n",
       "4                                       NaN   \n",
       "\n",
       "                                                 loc  \\\n",
       "0  location: Bay of PlentyBay of Plentyarea: Taur...   \n",
       "1  location: Bay of PlentyBay of Plentyarea: Taur...   \n",
       "2                         location: AucklandAuckland   \n",
       "3  location: SouthlandSouthlandarea: Invercargill...   \n",
       "4  location: CanterburyCanterburyarea: Christchur...   \n",
       "\n",
       "                         post_day  \\\n",
       "0  Featured,at,Private Advertiser   \n",
       "1                     Featured,at   \n",
       "2                       4d ago,at   \n",
       "3                       1h ago,at   \n",
       "4    4d ago,at,Private Advertiser   \n",
       "\n",
       "                                      classification      location  \\\n",
       "0  classification: Administration & Office Suppor...      Tauranga   \n",
       "1  classification: Administration & Office Suppor...      Tauranga   \n",
       "2  classification: Administration & Office Suppor...       unknown   \n",
       "3  classification: Administration & Office Suppor...  Invercargill   \n",
       "4  classification: Administration & Office Suppor...  Christchurch   \n",
       "\n",
       "            area delete1  \n",
       "0  Bay of Plenty          \n",
       "1  Bay of Plenty          \n",
       "2       Auckland    None  \n",
       "3      Southland          \n",
       "4     Canterbury          "
      ]
     },
     "execution_count": 563,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## drop loc and delete1 column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 564,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new.drop(columns = ['loc','delete1'],inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 565,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Featured,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>Featured,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>4d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Auckland</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>1h ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Invercargill</td>\n",
       "      <td>Southland</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4d ago,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Christchurch</td>\n",
       "      <td>Canterbury</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   role  \\\n",
       "0                         Administrator   \n",
       "1                          Receptionist   \n",
       "2          Prosecutions Support Officer   \n",
       "3  Early Childhood Centre Administrator   \n",
       "4        Business Support Administrator   \n",
       "\n",
       "                                        website_link  \\\n",
       "0  https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1  https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2  https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3  https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4  https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "\n",
       "                                    company                        post_day  \\\n",
       "0                                       NaN  Featured,at,Private Advertiser   \n",
       "1                      Avenues Orthodontics                     Featured,at   \n",
       "2                        New Zealand Police                       4d ago,at   \n",
       "3  Kew Pacific Island Early Learning Centre                       1h ago,at   \n",
       "4                                       NaN    4d ago,at,Private Advertiser   \n",
       "\n",
       "                                      classification      location  \\\n",
       "0  classification: Administration & Office Suppor...      Tauranga   \n",
       "1  classification: Administration & Office Suppor...      Tauranga   \n",
       "2  classification: Administration & Office Suppor...       unknown   \n",
       "3  classification: Administration & Office Suppor...  Invercargill   \n",
       "4  classification: Administration & Office Suppor...  Christchurch   \n",
       "\n",
       "            area  \n",
       "0  Bay of Plenty  \n",
       "1  Bay of Plenty  \n",
       "2       Auckland  \n",
       "3      Southland  \n",
       "4     Canterbury  "
      ]
     },
     "execution_count": 565,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 566,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'classification: Administration & Office SupportAdministration & Office SupportsubClassification: Office ManagementOffice Management'"
      ]
     },
     "execution_count": 566,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new['classification'][0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 567,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'$19 to $22 per hour'"
      ]
     },
     "execution_count": 567,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new['classification'][23]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## create salary column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 568,
   "metadata": {},
   "outputs": [],
   "source": [
    "def salary(a):\n",
    "    if \"classification\" in a :\n",
    "        return 'unknown'\n",
    "    else:\n",
    "        return a "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 569,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['salary']= csv_new['classification'].apply(salary)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 570,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'unknown'"
      ]
     },
     "execution_count": 570,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new['salary'][0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 571,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'$19 to $22 per hour'"
      ]
     },
     "execution_count": 571,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new['salary'][23]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 572,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Featured,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>Featured,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>4d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>1h ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Invercargill</td>\n",
       "      <td>Southland</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4d ago,at,Private Advertiser</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Christchurch</td>\n",
       "      <td>Canterbury</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   role  \\\n",
       "0                         Administrator   \n",
       "1                          Receptionist   \n",
       "2          Prosecutions Support Officer   \n",
       "3  Early Childhood Centre Administrator   \n",
       "4        Business Support Administrator   \n",
       "\n",
       "                                        website_link  \\\n",
       "0  https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1  https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2  https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3  https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4  https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "\n",
       "                                    company                        post_day  \\\n",
       "0                                       NaN  Featured,at,Private Advertiser   \n",
       "1                      Avenues Orthodontics                     Featured,at   \n",
       "2                        New Zealand Police                       4d ago,at   \n",
       "3  Kew Pacific Island Early Learning Centre                       1h ago,at   \n",
       "4                                       NaN    4d ago,at,Private Advertiser   \n",
       "\n",
       "                                      classification      location  \\\n",
       "0  classification: Administration & Office Suppor...      Tauranga   \n",
       "1  classification: Administration & Office Suppor...      Tauranga   \n",
       "2  classification: Administration & Office Suppor...       unknown   \n",
       "3  classification: Administration & Office Suppor...  Invercargill   \n",
       "4  classification: Administration & Office Suppor...  Christchurch   \n",
       "\n",
       "            area   salary  \n",
       "0  Bay of Plenty  unknown  \n",
       "1  Bay of Plenty  unknown  \n",
       "2       Auckland  unknown  \n",
       "3      Southland  unknown  \n",
       "4     Canterbury  unknown  "
      ]
     },
     "execution_count": 572,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## split classification into two pieces"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 573,
   "metadata": {},
   "outputs": [],
   "source": [
    "# clean out $23- $25 per hour\n",
    "def classifi(a):\n",
    "    if \"classification\" not in a :\n",
    "        return None\n",
    "    else:\n",
    "        return a "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 574,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['classification']=csv_new['classification'].apply(classifi)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 575,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>2703</td>\n",
       "      <td>Key Account Manager</td>\n",
       "      <td>https://www.seek.co.nz/job/50490062?type=stand...</td>\n",
       "      <td>Hays Talent Solutions</td>\n",
       "      <td>27d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Auckland Central</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2704</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50488000?type=stand...</td>\n",
       "      <td>one eighty recruitment</td>\n",
       "      <td>27d ago,at</td>\n",
       "      <td>None</td>\n",
       "      <td>Wellington Central</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>Competitive hourly rate</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2705</td>\n",
       "      <td>Temporary Office Roles</td>\n",
       "      <td>https://www.seek.co.nz/job/50524865?type=stand...</td>\n",
       "      <td>Asset Recruitment Ltd</td>\n",
       "      <td>20d ago,at</td>\n",
       "      <td>None</td>\n",
       "      <td>Hamilton</td>\n",
       "      <td>Waikato</td>\n",
       "      <td>Competitive hourly rates $$</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2706</td>\n",
       "      <td>Temporary Office Roles</td>\n",
       "      <td>https://www.seek.co.nz/job/50477118?type=stand...</td>\n",
       "      <td>Asset Recruitment Ltd</td>\n",
       "      <td>28d ago,at</td>\n",
       "      <td>None</td>\n",
       "      <td>Hamilton</td>\n",
       "      <td>Waikato</td>\n",
       "      <td>Competitive hourly rates $$</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2707</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50496571?type=stand...</td>\n",
       "      <td>Alpha Recruitment - NZ</td>\n",
       "      <td>26d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        role  \\\n",
       "2703     Key Account Manager   \n",
       "2704     Executive Assistant   \n",
       "2705  Temporary Office Roles   \n",
       "2706  Temporary Office Roles   \n",
       "2707     Executive Assistant   \n",
       "\n",
       "                                           website_link  \\\n",
       "2703  https://www.seek.co.nz/job/50490062?type=stand...   \n",
       "2704  https://www.seek.co.nz/job/50488000?type=stand...   \n",
       "2705  https://www.seek.co.nz/job/50524865?type=stand...   \n",
       "2706  https://www.seek.co.nz/job/50477118?type=stand...   \n",
       "2707  https://www.seek.co.nz/job/50496571?type=stand...   \n",
       "\n",
       "                     company    post_day  \\\n",
       "2703   Hays Talent Solutions  27d ago,at   \n",
       "2704  one eighty recruitment  27d ago,at   \n",
       "2705   Asset Recruitment Ltd  20d ago,at   \n",
       "2706   Asset Recruitment Ltd  28d ago,at   \n",
       "2707  Alpha Recruitment - NZ  26d ago,at   \n",
       "\n",
       "                                         classification            location  \\\n",
       "2703  classification: Administration & Office Suppor...    Auckland Central   \n",
       "2704                                               None  Wellington Central   \n",
       "2705                                               None            Hamilton   \n",
       "2706                                               None            Hamilton   \n",
       "2707  classification: Administration & Office Suppor...             unknown   \n",
       "\n",
       "            area                       salary  \n",
       "2703    Auckland                      unknown  \n",
       "2704  Wellington      Competitive hourly rate  \n",
       "2705     Waikato  Competitive hourly rates $$  \n",
       "2706     Waikato  Competitive hourly rates $$  \n",
       "2707  Wellington                      unknown  "
      ]
     },
     "execution_count": 575,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.tail()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 576,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['classification'] = csv_new['classification'].fillna('unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 577,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>2703</td>\n",
       "      <td>Key Account Manager</td>\n",
       "      <td>https://www.seek.co.nz/job/50490062?type=stand...</td>\n",
       "      <td>Hays Talent Solutions</td>\n",
       "      <td>27d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>Auckland Central</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2704</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50488000?type=stand...</td>\n",
       "      <td>one eighty recruitment</td>\n",
       "      <td>27d ago,at</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Wellington Central</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>Competitive hourly rate</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2705</td>\n",
       "      <td>Temporary Office Roles</td>\n",
       "      <td>https://www.seek.co.nz/job/50524865?type=stand...</td>\n",
       "      <td>Asset Recruitment Ltd</td>\n",
       "      <td>20d ago,at</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Hamilton</td>\n",
       "      <td>Waikato</td>\n",
       "      <td>Competitive hourly rates $$</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2706</td>\n",
       "      <td>Temporary Office Roles</td>\n",
       "      <td>https://www.seek.co.nz/job/50477118?type=stand...</td>\n",
       "      <td>Asset Recruitment Ltd</td>\n",
       "      <td>28d ago,at</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Hamilton</td>\n",
       "      <td>Waikato</td>\n",
       "      <td>Competitive hourly rates $$</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2707</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50496571?type=stand...</td>\n",
       "      <td>Alpha Recruitment - NZ</td>\n",
       "      <td>26d ago,at</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        role  \\\n",
       "2703     Key Account Manager   \n",
       "2704     Executive Assistant   \n",
       "2705  Temporary Office Roles   \n",
       "2706  Temporary Office Roles   \n",
       "2707     Executive Assistant   \n",
       "\n",
       "                                           website_link  \\\n",
       "2703  https://www.seek.co.nz/job/50490062?type=stand...   \n",
       "2704  https://www.seek.co.nz/job/50488000?type=stand...   \n",
       "2705  https://www.seek.co.nz/job/50524865?type=stand...   \n",
       "2706  https://www.seek.co.nz/job/50477118?type=stand...   \n",
       "2707  https://www.seek.co.nz/job/50496571?type=stand...   \n",
       "\n",
       "                     company    post_day  \\\n",
       "2703   Hays Talent Solutions  27d ago,at   \n",
       "2704  one eighty recruitment  27d ago,at   \n",
       "2705   Asset Recruitment Ltd  20d ago,at   \n",
       "2706   Asset Recruitment Ltd  28d ago,at   \n",
       "2707  Alpha Recruitment - NZ  26d ago,at   \n",
       "\n",
       "                                         classification            location  \\\n",
       "2703  classification: Administration & Office Suppor...    Auckland Central   \n",
       "2704                                            unknown  Wellington Central   \n",
       "2705                                            unknown            Hamilton   \n",
       "2706                                            unknown            Hamilton   \n",
       "2707  classification: Administration & Office Suppor...             unknown   \n",
       "\n",
       "            area                       salary  \n",
       "2703    Auckland                      unknown  \n",
       "2704  Wellington      Competitive hourly rate  \n",
       "2705     Waikato  Competitive hourly rates $$  \n",
       "2706     Waikato  Competitive hourly rates $$  \n",
       "2707  Wellington                      unknown  "
      ]
     },
     "execution_count": 577,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.tail()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 578,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new[['classification_change','classification']] = csv_new['classification'].str.split('subClassification: ',expand =True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 579,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "      <th>classification_change</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>2703</td>\n",
       "      <td>Key Account Manager</td>\n",
       "      <td>https://www.seek.co.nz/job/50490062?type=stand...</td>\n",
       "      <td>Hays Talent Solutions</td>\n",
       "      <td>27d ago,at</td>\n",
       "      <td>Client &amp; Sales AdministrationClient &amp; Sales Ad...</td>\n",
       "      <td>Auckland Central</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2704</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50488000?type=stand...</td>\n",
       "      <td>one eighty recruitment</td>\n",
       "      <td>27d ago,at</td>\n",
       "      <td>None</td>\n",
       "      <td>Wellington Central</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>Competitive hourly rate</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2705</td>\n",
       "      <td>Temporary Office Roles</td>\n",
       "      <td>https://www.seek.co.nz/job/50524865?type=stand...</td>\n",
       "      <td>Asset Recruitment Ltd</td>\n",
       "      <td>20d ago,at</td>\n",
       "      <td>None</td>\n",
       "      <td>Hamilton</td>\n",
       "      <td>Waikato</td>\n",
       "      <td>Competitive hourly rates $$</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2706</td>\n",
       "      <td>Temporary Office Roles</td>\n",
       "      <td>https://www.seek.co.nz/job/50477118?type=stand...</td>\n",
       "      <td>Asset Recruitment Ltd</td>\n",
       "      <td>28d ago,at</td>\n",
       "      <td>None</td>\n",
       "      <td>Hamilton</td>\n",
       "      <td>Waikato</td>\n",
       "      <td>Competitive hourly rates $$</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2707</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50496571?type=stand...</td>\n",
       "      <td>Alpha Recruitment - NZ</td>\n",
       "      <td>26d ago,at</td>\n",
       "      <td>PA, EA &amp; SecretarialPA, EA &amp; Secretarial</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>unknown</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        role  \\\n",
       "2703     Key Account Manager   \n",
       "2704     Executive Assistant   \n",
       "2705  Temporary Office Roles   \n",
       "2706  Temporary Office Roles   \n",
       "2707     Executive Assistant   \n",
       "\n",
       "                                           website_link  \\\n",
       "2703  https://www.seek.co.nz/job/50490062?type=stand...   \n",
       "2704  https://www.seek.co.nz/job/50488000?type=stand...   \n",
       "2705  https://www.seek.co.nz/job/50524865?type=stand...   \n",
       "2706  https://www.seek.co.nz/job/50477118?type=stand...   \n",
       "2707  https://www.seek.co.nz/job/50496571?type=stand...   \n",
       "\n",
       "                     company    post_day  \\\n",
       "2703   Hays Talent Solutions  27d ago,at   \n",
       "2704  one eighty recruitment  27d ago,at   \n",
       "2705   Asset Recruitment Ltd  20d ago,at   \n",
       "2706   Asset Recruitment Ltd  28d ago,at   \n",
       "2707  Alpha Recruitment - NZ  26d ago,at   \n",
       "\n",
       "                                         classification            location  \\\n",
       "2703  Client & Sales AdministrationClient & Sales Ad...    Auckland Central   \n",
       "2704                                               None  Wellington Central   \n",
       "2705                                               None            Hamilton   \n",
       "2706                                               None            Hamilton   \n",
       "2707           PA, EA & SecretarialPA, EA & Secretarial             unknown   \n",
       "\n",
       "            area                       salary  \\\n",
       "2703    Auckland                      unknown   \n",
       "2704  Wellington      Competitive hourly rate   \n",
       "2705     Waikato  Competitive hourly rates $$   \n",
       "2706     Waikato  Competitive hourly rates $$   \n",
       "2707  Wellington                      unknown   \n",
       "\n",
       "                                  classification_change  \n",
       "2703  classification: Administration & Office Suppor...  \n",
       "2704                                            unknown  \n",
       "2705                                            unknown  \n",
       "2706                                            unknown  \n",
       "2707  classification: Administration & Office Suppor...  "
      ]
     },
     "execution_count": 579,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.tail()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## clean dulplicate value of classification column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 580,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 580,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new['classification'].isna().any()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 581,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['classification']=csv_new['classification'].fillna('unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 582,
   "metadata": {},
   "outputs": [],
   "source": [
    "#csv_new['classification'] = csv_new['classification'].str.replace('(\\,[\\s\\S]*)',\"\",regex = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 583,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "False"
      ]
     },
     "execution_count": 583,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new['classification'].isna().any()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 584,
   "metadata": {},
   "outputs": [],
   "source": [
    "def dulplicate(a):\n",
    "    mid = len(a)//2\n",
    "    if a == 'unknown':\n",
    "        return 'unknown'\n",
    "    else:\n",
    "        return a[mid:]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 585,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['classification'] = csv_new['classification'].apply(dulplicate)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 586,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "      <th>classification_change</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>2703</td>\n",
       "      <td>Key Account Manager</td>\n",
       "      <td>https://www.seek.co.nz/job/50490062?type=stand...</td>\n",
       "      <td>Hays Talent Solutions</td>\n",
       "      <td>27d ago,at</td>\n",
       "      <td>Client &amp; Sales Administration</td>\n",
       "      <td>Auckland Central</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2704</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50488000?type=stand...</td>\n",
       "      <td>one eighty recruitment</td>\n",
       "      <td>27d ago,at</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Wellington Central</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>Competitive hourly rate</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2705</td>\n",
       "      <td>Temporary Office Roles</td>\n",
       "      <td>https://www.seek.co.nz/job/50524865?type=stand...</td>\n",
       "      <td>Asset Recruitment Ltd</td>\n",
       "      <td>20d ago,at</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Hamilton</td>\n",
       "      <td>Waikato</td>\n",
       "      <td>Competitive hourly rates $$</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2706</td>\n",
       "      <td>Temporary Office Roles</td>\n",
       "      <td>https://www.seek.co.nz/job/50477118?type=stand...</td>\n",
       "      <td>Asset Recruitment Ltd</td>\n",
       "      <td>28d ago,at</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Hamilton</td>\n",
       "      <td>Waikato</td>\n",
       "      <td>Competitive hourly rates $$</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2707</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50496571?type=stand...</td>\n",
       "      <td>Alpha Recruitment - NZ</td>\n",
       "      <td>26d ago,at</td>\n",
       "      <td>PA, EA &amp; Secretarial</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>unknown</td>\n",
       "      <td>classification: Administration &amp; Office Suppor...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        role  \\\n",
       "2703     Key Account Manager   \n",
       "2704     Executive Assistant   \n",
       "2705  Temporary Office Roles   \n",
       "2706  Temporary Office Roles   \n",
       "2707     Executive Assistant   \n",
       "\n",
       "                                           website_link  \\\n",
       "2703  https://www.seek.co.nz/job/50490062?type=stand...   \n",
       "2704  https://www.seek.co.nz/job/50488000?type=stand...   \n",
       "2705  https://www.seek.co.nz/job/50524865?type=stand...   \n",
       "2706  https://www.seek.co.nz/job/50477118?type=stand...   \n",
       "2707  https://www.seek.co.nz/job/50496571?type=stand...   \n",
       "\n",
       "                     company    post_day                 classification  \\\n",
       "2703   Hays Talent Solutions  27d ago,at  Client & Sales Administration   \n",
       "2704  one eighty recruitment  27d ago,at                        unknown   \n",
       "2705   Asset Recruitment Ltd  20d ago,at                        unknown   \n",
       "2706   Asset Recruitment Ltd  28d ago,at                        unknown   \n",
       "2707  Alpha Recruitment - NZ  26d ago,at           PA, EA & Secretarial   \n",
       "\n",
       "                location        area                       salary  \\\n",
       "2703    Auckland Central    Auckland                      unknown   \n",
       "2704  Wellington Central  Wellington      Competitive hourly rate   \n",
       "2705            Hamilton     Waikato  Competitive hourly rates $$   \n",
       "2706            Hamilton     Waikato  Competitive hourly rates $$   \n",
       "2707             unknown  Wellington                      unknown   \n",
       "\n",
       "                                  classification_change  \n",
       "2703  classification: Administration & Office Suppor...  \n",
       "2704                                            unknown  \n",
       "2705                                            unknown  \n",
       "2706                                            unknown  \n",
       "2707  classification: Administration & Office Suppor...  "
      ]
     },
     "execution_count": 586,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.tail()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## drop classification: in the classification_change problem"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 587,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "15"
      ]
     },
     "execution_count": 587,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "len('classification:')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 588,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['classification_change'] = csv_new['classification_change'].apply(lambda x:x[15:])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 589,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "      <th>classification_change</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>2703</td>\n",
       "      <td>Key Account Manager</td>\n",
       "      <td>https://www.seek.co.nz/job/50490062?type=stand...</td>\n",
       "      <td>Hays Talent Solutions</td>\n",
       "      <td>27d ago,at</td>\n",
       "      <td>Client &amp; Sales Administration</td>\n",
       "      <td>Auckland Central</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration &amp; Office SupportAdministration...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2704</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50488000?type=stand...</td>\n",
       "      <td>one eighty recruitment</td>\n",
       "      <td>27d ago,at</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Wellington Central</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>Competitive hourly rate</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2705</td>\n",
       "      <td>Temporary Office Roles</td>\n",
       "      <td>https://www.seek.co.nz/job/50524865?type=stand...</td>\n",
       "      <td>Asset Recruitment Ltd</td>\n",
       "      <td>20d ago,at</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Hamilton</td>\n",
       "      <td>Waikato</td>\n",
       "      <td>Competitive hourly rates $$</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2706</td>\n",
       "      <td>Temporary Office Roles</td>\n",
       "      <td>https://www.seek.co.nz/job/50477118?type=stand...</td>\n",
       "      <td>Asset Recruitment Ltd</td>\n",
       "      <td>28d ago,at</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Hamilton</td>\n",
       "      <td>Waikato</td>\n",
       "      <td>Competitive hourly rates $$</td>\n",
       "      <td></td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2707</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50496571?type=stand...</td>\n",
       "      <td>Alpha Recruitment - NZ</td>\n",
       "      <td>26d ago,at</td>\n",
       "      <td>PA, EA &amp; Secretarial</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration &amp; Office SupportAdministration...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        role  \\\n",
       "2703     Key Account Manager   \n",
       "2704     Executive Assistant   \n",
       "2705  Temporary Office Roles   \n",
       "2706  Temporary Office Roles   \n",
       "2707     Executive Assistant   \n",
       "\n",
       "                                           website_link  \\\n",
       "2703  https://www.seek.co.nz/job/50490062?type=stand...   \n",
       "2704  https://www.seek.co.nz/job/50488000?type=stand...   \n",
       "2705  https://www.seek.co.nz/job/50524865?type=stand...   \n",
       "2706  https://www.seek.co.nz/job/50477118?type=stand...   \n",
       "2707  https://www.seek.co.nz/job/50496571?type=stand...   \n",
       "\n",
       "                     company    post_day                 classification  \\\n",
       "2703   Hays Talent Solutions  27d ago,at  Client & Sales Administration   \n",
       "2704  one eighty recruitment  27d ago,at                        unknown   \n",
       "2705   Asset Recruitment Ltd  20d ago,at                        unknown   \n",
       "2706   Asset Recruitment Ltd  28d ago,at                        unknown   \n",
       "2707  Alpha Recruitment - NZ  26d ago,at           PA, EA & Secretarial   \n",
       "\n",
       "                location        area                       salary  \\\n",
       "2703    Auckland Central    Auckland                      unknown   \n",
       "2704  Wellington Central  Wellington      Competitive hourly rate   \n",
       "2705            Hamilton     Waikato  Competitive hourly rates $$   \n",
       "2706            Hamilton     Waikato  Competitive hourly rates $$   \n",
       "2707             unknown  Wellington                      unknown   \n",
       "\n",
       "                                  classification_change  \n",
       "2703   Administration & Office SupportAdministration...  \n",
       "2704                                                     \n",
       "2705                                                     \n",
       "2706                                                     \n",
       "2707   Administration & Office SupportAdministration...  "
      ]
     },
     "execution_count": 589,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.tail()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## split classification change into classification1, classification2, classification3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 590,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new[['classification1','classification2','classification3']] = csv_new['classification_change'].str.split(' & ',expand = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 591,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "      <th>classification_change</th>\n",
       "      <th>classification1</th>\n",
       "      <th>classification2</th>\n",
       "      <th>classification3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>2703</td>\n",
       "      <td>Key Account Manager</td>\n",
       "      <td>https://www.seek.co.nz/job/50490062?type=stand...</td>\n",
       "      <td>Hays Talent Solutions</td>\n",
       "      <td>27d ago,at</td>\n",
       "      <td>Client &amp; Sales Administration</td>\n",
       "      <td>Auckland Central</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration &amp; Office SupportAdministration...</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2704</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50488000?type=stand...</td>\n",
       "      <td>one eighty recruitment</td>\n",
       "      <td>27d ago,at</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Wellington Central</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>Competitive hourly rate</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2705</td>\n",
       "      <td>Temporary Office Roles</td>\n",
       "      <td>https://www.seek.co.nz/job/50524865?type=stand...</td>\n",
       "      <td>Asset Recruitment Ltd</td>\n",
       "      <td>20d ago,at</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Hamilton</td>\n",
       "      <td>Waikato</td>\n",
       "      <td>Competitive hourly rates $$</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2706</td>\n",
       "      <td>Temporary Office Roles</td>\n",
       "      <td>https://www.seek.co.nz/job/50477118?type=stand...</td>\n",
       "      <td>Asset Recruitment Ltd</td>\n",
       "      <td>28d ago,at</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Hamilton</td>\n",
       "      <td>Waikato</td>\n",
       "      <td>Competitive hourly rates $$</td>\n",
       "      <td></td>\n",
       "      <td></td>\n",
       "      <td>None</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2707</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50496571?type=stand...</td>\n",
       "      <td>Alpha Recruitment - NZ</td>\n",
       "      <td>26d ago,at</td>\n",
       "      <td>PA, EA &amp; Secretarial</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration &amp; Office SupportAdministration...</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        role  \\\n",
       "2703     Key Account Manager   \n",
       "2704     Executive Assistant   \n",
       "2705  Temporary Office Roles   \n",
       "2706  Temporary Office Roles   \n",
       "2707     Executive Assistant   \n",
       "\n",
       "                                           website_link  \\\n",
       "2703  https://www.seek.co.nz/job/50490062?type=stand...   \n",
       "2704  https://www.seek.co.nz/job/50488000?type=stand...   \n",
       "2705  https://www.seek.co.nz/job/50524865?type=stand...   \n",
       "2706  https://www.seek.co.nz/job/50477118?type=stand...   \n",
       "2707  https://www.seek.co.nz/job/50496571?type=stand...   \n",
       "\n",
       "                     company    post_day                 classification  \\\n",
       "2703   Hays Talent Solutions  27d ago,at  Client & Sales Administration   \n",
       "2704  one eighty recruitment  27d ago,at                        unknown   \n",
       "2705   Asset Recruitment Ltd  20d ago,at                        unknown   \n",
       "2706   Asset Recruitment Ltd  28d ago,at                        unknown   \n",
       "2707  Alpha Recruitment - NZ  26d ago,at           PA, EA & Secretarial   \n",
       "\n",
       "                location        area                       salary  \\\n",
       "2703    Auckland Central    Auckland                      unknown   \n",
       "2704  Wellington Central  Wellington      Competitive hourly rate   \n",
       "2705            Hamilton     Waikato  Competitive hourly rates $$   \n",
       "2706            Hamilton     Waikato  Competitive hourly rates $$   \n",
       "2707             unknown  Wellington                      unknown   \n",
       "\n",
       "                                  classification_change  classification1  \\\n",
       "2703   Administration & Office SupportAdministration...   Administration   \n",
       "2704                                                                       \n",
       "2705                                                                       \n",
       "2706                                                                       \n",
       "2707   Administration & Office SupportAdministration...   Administration   \n",
       "\n",
       "                   classification2 classification3  \n",
       "2703  Office SupportAdministration  Office Support  \n",
       "2704                          None            None  \n",
       "2705                          None            None  \n",
       "2706                          None            None  \n",
       "2707  Office SupportAdministration  Office Support  "
      ]
     },
     "execution_count": 591,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.tail()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## drop the classification_change column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 592,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new.drop(columns = ['classification_change'], inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 593,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "      <th>classification1</th>\n",
       "      <th>classification2</th>\n",
       "      <th>classification3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>2707</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50496571?type=stand...</td>\n",
       "      <td>Alpha Recruitment - NZ</td>\n",
       "      <td>26d ago,at</td>\n",
       "      <td>PA, EA &amp; Secretarial</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                     role                                       website_link  \\\n",
       "2707  Executive Assistant  https://www.seek.co.nz/job/50496571?type=stand...   \n",
       "\n",
       "                     company    post_day        classification location  \\\n",
       "2707  Alpha Recruitment - NZ  26d ago,at  PA, EA & Secretarial  unknown   \n",
       "\n",
       "            area   salary  classification1               classification2  \\\n",
       "2707  Wellington  unknown   Administration  Office SupportAdministration   \n",
       "\n",
       "     classification3  \n",
       "2707  Office Support  "
      ]
     },
     "execution_count": 593,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.tail(1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## split post day into two pieces that is post day and feature at column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 594,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new[['post_time','feature_at']] = csv_new['post_day'].str.split(',at,', expand = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 595,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "      <th>classification1</th>\n",
       "      <th>classification2</th>\n",
       "      <th>classification3</th>\n",
       "      <th>post_time</th>\n",
       "      <th>feature_at</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Featured,at,Private Advertiser</td>\n",
       "      <td>Office Management</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>Featured</td>\n",
       "      <td>Private Advertiser</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>Featured,at</td>\n",
       "      <td>Receptionists</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>Featured,at</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>4d ago,at</td>\n",
       "      <td>Other</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>4d ago,at</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>1h ago,at</td>\n",
       "      <td>Administrative Assistants</td>\n",
       "      <td>Invercargill</td>\n",
       "      <td>Southland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>1h ago,at</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>4d ago,at,Private Advertiser</td>\n",
       "      <td>Client &amp; Sales Administration</td>\n",
       "      <td>Christchurch</td>\n",
       "      <td>Canterbury</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>4d ago</td>\n",
       "      <td>Private Advertiser</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   role  \\\n",
       "0                         Administrator   \n",
       "1                          Receptionist   \n",
       "2          Prosecutions Support Officer   \n",
       "3  Early Childhood Centre Administrator   \n",
       "4        Business Support Administrator   \n",
       "\n",
       "                                        website_link  \\\n",
       "0  https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1  https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2  https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3  https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4  https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "\n",
       "                                    company                        post_day  \\\n",
       "0                                       NaN  Featured,at,Private Advertiser   \n",
       "1                      Avenues Orthodontics                     Featured,at   \n",
       "2                        New Zealand Police                       4d ago,at   \n",
       "3  Kew Pacific Island Early Learning Centre                       1h ago,at   \n",
       "4                                       NaN    4d ago,at,Private Advertiser   \n",
       "\n",
       "                  classification      location           area   salary  \\\n",
       "0              Office Management      Tauranga  Bay of Plenty  unknown   \n",
       "1                  Receptionists      Tauranga  Bay of Plenty  unknown   \n",
       "2                          Other       unknown       Auckland  unknown   \n",
       "3      Administrative Assistants  Invercargill      Southland  unknown   \n",
       "4  Client & Sales Administration  Christchurch     Canterbury  unknown   \n",
       "\n",
       "   classification1               classification2 classification3    post_time  \\\n",
       "0   Administration  Office SupportAdministration  Office Support     Featured   \n",
       "1   Administration  Office SupportAdministration  Office Support  Featured,at   \n",
       "2   Administration  Office SupportAdministration  Office Support    4d ago,at   \n",
       "3   Administration  Office SupportAdministration  Office Support    1h ago,at   \n",
       "4   Administration  Office SupportAdministration  Office Support       4d ago   \n",
       "\n",
       "           feature_at  \n",
       "0  Private Advertiser  \n",
       "1                None  \n",
       "2                None  \n",
       "3                None  \n",
       "4  Private Advertiser  "
      ]
     },
     "execution_count": 595,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## check missing value"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 596,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "role               False\n",
       "website_link       False\n",
       "company             True\n",
       "post_day           False\n",
       "classification     False\n",
       "location           False\n",
       "area               False\n",
       "salary             False\n",
       "classification1    False\n",
       "classification2     True\n",
       "classification3     True\n",
       "post_time          False\n",
       "feature_at          True\n",
       "dtype: bool"
      ]
     },
     "execution_count": 596,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.isna().any()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 597,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['classification1']= csv_new['classification1'].fillna('unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 598,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['classification2']= csv_new['classification2'].fillna('unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 599,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['classification3']= csv_new['classification3'].fillna('unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 600,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['company'] = csv_new['company'].fillna('unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 601,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['post_time']= csv_new['post_time'].fillna('unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 602,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['feature_at'] = csv_new['feature_at'].fillna('unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 603,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "role               False\n",
       "website_link       False\n",
       "company            False\n",
       "post_day           False\n",
       "classification     False\n",
       "location           False\n",
       "area               False\n",
       "salary             False\n",
       "classification1    False\n",
       "classification2    False\n",
       "classification3    False\n",
       "post_time          False\n",
       "feature_at         False\n",
       "dtype: bool"
      ]
     },
     "execution_count": 603,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.isna().any()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## manipulate post_time column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 604,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['post_time']= csv_new['post_time'].str.extract('(\\d+[a-z]+)',expand = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 605,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "      <th>classification1</th>\n",
       "      <th>classification2</th>\n",
       "      <th>classification3</th>\n",
       "      <th>post_time</th>\n",
       "      <th>feature_at</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Featured,at,Private Advertiser</td>\n",
       "      <td>Office Management</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Private Advertiser</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>Featured,at</td>\n",
       "      <td>Receptionists</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>NaN</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>4d ago,at</td>\n",
       "      <td>Other</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>4d</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>1h ago,at</td>\n",
       "      <td>Administrative Assistants</td>\n",
       "      <td>Invercargill</td>\n",
       "      <td>Southland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>1h</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>4d ago,at,Private Advertiser</td>\n",
       "      <td>Client &amp; Sales Administration</td>\n",
       "      <td>Christchurch</td>\n",
       "      <td>Canterbury</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>4d</td>\n",
       "      <td>Private Advertiser</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   role  \\\n",
       "0                         Administrator   \n",
       "1                          Receptionist   \n",
       "2          Prosecutions Support Officer   \n",
       "3  Early Childhood Centre Administrator   \n",
       "4        Business Support Administrator   \n",
       "\n",
       "                                        website_link  \\\n",
       "0  https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1  https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2  https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3  https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4  https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "\n",
       "                                    company                        post_day  \\\n",
       "0                                   unknown  Featured,at,Private Advertiser   \n",
       "1                      Avenues Orthodontics                     Featured,at   \n",
       "2                        New Zealand Police                       4d ago,at   \n",
       "3  Kew Pacific Island Early Learning Centre                       1h ago,at   \n",
       "4                                   unknown    4d ago,at,Private Advertiser   \n",
       "\n",
       "                  classification      location           area   salary  \\\n",
       "0              Office Management      Tauranga  Bay of Plenty  unknown   \n",
       "1                  Receptionists      Tauranga  Bay of Plenty  unknown   \n",
       "2                          Other       unknown       Auckland  unknown   \n",
       "3      Administrative Assistants  Invercargill      Southland  unknown   \n",
       "4  Client & Sales Administration  Christchurch     Canterbury  unknown   \n",
       "\n",
       "   classification1               classification2 classification3 post_time  \\\n",
       "0   Administration  Office SupportAdministration  Office Support       NaN   \n",
       "1   Administration  Office SupportAdministration  Office Support       NaN   \n",
       "2   Administration  Office SupportAdministration  Office Support        4d   \n",
       "3   Administration  Office SupportAdministration  Office Support        1h   \n",
       "4   Administration  Office SupportAdministration  Office Support        4d   \n",
       "\n",
       "           feature_at  \n",
       "0  Private Advertiser  \n",
       "1             unknown  \n",
       "2             unknown  \n",
       "3             unknown  \n",
       "4  Private Advertiser  "
      ]
     },
     "execution_count": 605,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 606,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['post_time'] = csv_new['post_time'].astype('str')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 607,
   "metadata": {},
   "outputs": [],
   "source": [
    "def post_time(a):\n",
    "    if 'd' in a:\n",
    "        find1 = int(a.index('d'))\n",
    "        return -int(a[:find1])\n",
    "    elif \"m\" in a:\n",
    "        find2 = a.index('m')\n",
    "        final = -int(a[:find2]) *30\n",
    "        return final \n",
    "    else:\n",
    "        return 0\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 608,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['post_time'] = csv_new['post_time'].apply(post_time)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 609,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>post_day</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "      <th>classification1</th>\n",
       "      <th>classification2</th>\n",
       "      <th>classification3</th>\n",
       "      <th>post_time</th>\n",
       "      <th>feature_at</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Featured,at,Private Advertiser</td>\n",
       "      <td>Office Management</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>Private Advertiser</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>Featured,at</td>\n",
       "      <td>Receptionists</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>4d ago,at</td>\n",
       "      <td>Other</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-4</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>1h ago,at</td>\n",
       "      <td>Administrative Assistants</td>\n",
       "      <td>Invercargill</td>\n",
       "      <td>Southland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>4d ago,at,Private Advertiser</td>\n",
       "      <td>Client &amp; Sales Administration</td>\n",
       "      <td>Christchurch</td>\n",
       "      <td>Canterbury</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-4</td>\n",
       "      <td>Private Advertiser</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   role  \\\n",
       "0                         Administrator   \n",
       "1                          Receptionist   \n",
       "2          Prosecutions Support Officer   \n",
       "3  Early Childhood Centre Administrator   \n",
       "4        Business Support Administrator   \n",
       "\n",
       "                                        website_link  \\\n",
       "0  https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1  https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2  https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3  https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4  https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "\n",
       "                                    company                        post_day  \\\n",
       "0                                   unknown  Featured,at,Private Advertiser   \n",
       "1                      Avenues Orthodontics                     Featured,at   \n",
       "2                        New Zealand Police                       4d ago,at   \n",
       "3  Kew Pacific Island Early Learning Centre                       1h ago,at   \n",
       "4                                   unknown    4d ago,at,Private Advertiser   \n",
       "\n",
       "                  classification      location           area   salary  \\\n",
       "0              Office Management      Tauranga  Bay of Plenty  unknown   \n",
       "1                  Receptionists      Tauranga  Bay of Plenty  unknown   \n",
       "2                          Other       unknown       Auckland  unknown   \n",
       "3      Administrative Assistants  Invercargill      Southland  unknown   \n",
       "4  Client & Sales Administration  Christchurch     Canterbury  unknown   \n",
       "\n",
       "   classification1               classification2 classification3  post_time  \\\n",
       "0   Administration  Office SupportAdministration  Office Support          0   \n",
       "1   Administration  Office SupportAdministration  Office Support          0   \n",
       "2   Administration  Office SupportAdministration  Office Support         -4   \n",
       "3   Administration  Office SupportAdministration  Office Support          0   \n",
       "4   Administration  Office SupportAdministration  Office Support         -4   \n",
       "\n",
       "           feature_at  \n",
       "0  Private Advertiser  \n",
       "1             unknown  \n",
       "2             unknown  \n",
       "3             unknown  \n",
       "4  Private Advertiser  "
      ]
     },
     "execution_count": 609,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 610,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new.drop(columns = ['post_day'],inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 611,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "      <th>classification1</th>\n",
       "      <th>classification2</th>\n",
       "      <th>classification3</th>\n",
       "      <th>post_time</th>\n",
       "      <th>feature_at</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Office Management</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>Private Advertiser</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>Receptionists</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>Other</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-4</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>Administrative Assistants</td>\n",
       "      <td>Invercargill</td>\n",
       "      <td>Southland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Client &amp; Sales Administration</td>\n",
       "      <td>Christchurch</td>\n",
       "      <td>Canterbury</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-4</td>\n",
       "      <td>Private Advertiser</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   role  \\\n",
       "0                         Administrator   \n",
       "1                          Receptionist   \n",
       "2          Prosecutions Support Officer   \n",
       "3  Early Childhood Centre Administrator   \n",
       "4        Business Support Administrator   \n",
       "\n",
       "                                        website_link  \\\n",
       "0  https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1  https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2  https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3  https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4  https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "\n",
       "                                    company                 classification  \\\n",
       "0                                   unknown              Office Management   \n",
       "1                      Avenues Orthodontics                  Receptionists   \n",
       "2                        New Zealand Police                          Other   \n",
       "3  Kew Pacific Island Early Learning Centre      Administrative Assistants   \n",
       "4                                   unknown  Client & Sales Administration   \n",
       "\n",
       "       location           area   salary  classification1  \\\n",
       "0      Tauranga  Bay of Plenty  unknown   Administration   \n",
       "1      Tauranga  Bay of Plenty  unknown   Administration   \n",
       "2       unknown       Auckland  unknown   Administration   \n",
       "3  Invercargill      Southland  unknown   Administration   \n",
       "4  Christchurch     Canterbury  unknown   Administration   \n",
       "\n",
       "                classification2 classification3  post_time          feature_at  \n",
       "0  Office SupportAdministration  Office Support          0  Private Advertiser  \n",
       "1  Office SupportAdministration  Office Support          0             unknown  \n",
       "2  Office SupportAdministration  Office Support         -4             unknown  \n",
       "3  Office SupportAdministration  Office Support          0             unknown  \n",
       "4  Office SupportAdministration  Office Support         -4  Private Advertiser  "
      ]
     },
     "execution_count": 611,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## clean salary data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 612,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "12                           $20 per hour\n",
       "17                  $20 - $24.99 per hour\n",
       "23                    $19 to $22 per hour\n",
       "25                  $20 - $24.99 per hour\n",
       "36                  $20 - $24.99 per hour\n",
       "                      ...                \n",
       "683     $35 - $40 p.h. + + 8% Holiday Pay\n",
       "695                             Circa 50k\n",
       "1936     $24 - $28 p.h.  + 8% Holiday Pay\n",
       "1937    $35 - $40 p.h. + + 8% Holiday Pay\n",
       "1949                            Circa 50k\n",
       "Name: salary, Length: 96, dtype: object"
      ]
     },
     "execution_count": 612,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new[csv_new['salary'].str.contains('\\d', na= False)]['salary']\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 613,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "306                                      $75k - $85k p.a.\n",
       "442                    $60k-$70k depending on experience!\n",
       "473     $60 - $65k + Career Progression to QS / leader...\n",
       "644                     $50k - $65k p.a. + plus kiwisaver\n",
       "650                                        $70-$80k+Super\n",
       "663                                     $70-75k per annum\n",
       "695                                             Circa 50k\n",
       "1949                                            Circa 50k\n",
       "Name: salary, dtype: object"
      ]
     },
     "execution_count": 613,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new[csv_new['salary'].str.contains('\\dk', na= False)]['salary']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 614,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "42                                      $40,000 - $49,999\n",
       "75                                      $55,000 - $69,999\n",
       "82                                      $55,000 - $64,999\n",
       "89                        $50,000 - $55,000 plus benefits\n",
       "97                                      $45,000 - $49,999\n",
       "103                  $55,000 - $60,000 per annum pro rata\n",
       "123                                     $48,835 - $63,221\n",
       "165                       $50,000 - $55,000 plus benefits\n",
       "212                                     $55,000 - $64,999\n",
       "214                                     $40,000 - $49,999\n",
       "219                                     $45,000 - $59,999\n",
       "264                                     $45,000 - $49,999\n",
       "318                                     $40,000 - $49,999\n",
       "319                                    $50,000 per annum.\n",
       "346                                     $55,000 - $64,999\n",
       "393                                           $45-$55,000\n",
       "398                                     $50,000 - $54,999\n",
       "430         NZD69,726-94,127p.a.+Retirement contributions\n",
       "455                                     $40,000 - $49,999\n",
       "482                                     $55,000 - $64,999\n",
       "532                                            $60,000 pa\n",
       "533                                     $40,000 - $49,999\n",
       "546                                     $60,000 - $69,999\n",
       "558                                     $50,000 - $59,999\n",
       "612                                     $50,000 - $69,999\n",
       "625                                     $50,000 - $59,999\n",
       "632                                     $50,000 - $64,999\n",
       "641                                     $48,000 - $55,000\n",
       "656                                     $45,000 - $54,999\n",
       "657         Competitive hourly rate, experience dependent\n",
       "660     $55,000 - $65,000 depending on relevant experi...\n",
       "679             $45,000 - $55,000 depending on experience\n",
       "691                 + Car park, close to public transport\n",
       "1945                + Car park, close to public transport\n",
       "Name: salary, dtype: object"
      ]
     },
     "execution_count": 614,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new[csv_new['salary'].str.contains(',', na= False)]['salary']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 615,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "201                        8% holiday pay\n",
       "311           $24 - $25 + 8% holiday pay!\n",
       "384       $30 - $38 p.h. + 8% Holiday Pay\n",
       "403     Up to $23 p.h. + + 8% Holiday Pay\n",
       "458       $27 - $33 p.h. + 8% holiday pay\n",
       "503       Up to $27 p.h. + 8% Holiday Pay\n",
       "536       $21 - $25 p.h. + 8% Holiday Pay\n",
       "578       Up to $35 p.h. + 8% Holiday Pay\n",
       "579       $21 - $22 p.h. + 8% Holiday Pay\n",
       "682      $24 - $28 p.h.  + 8% Holiday Pay\n",
       "683     $35 - $40 p.h. + + 8% Holiday Pay\n",
       "1936     $24 - $28 p.h.  + 8% Holiday Pay\n",
       "1937    $35 - $40 p.h. + + 8% Holiday Pay\n",
       "Name: salary, dtype: object"
      ]
     },
     "execution_count": 615,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new[csv_new['salary'].str.contains('\\d\\%', na= False)]['salary']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 616,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['salary'] = csv_new[csv_new['salary'].str.contains('\\d', na= False)]['salary'].str.replace('to','-',regex = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 617,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'$19 - $22 per hour'"
      ]
     },
     "execution_count": 617,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new['salary'][23]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 618,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['salary'] = csv_new[csv_new['salary'].str.contains('\\d',na = False)]['salary'].str.replace('k','000',regex = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 619,
   "metadata": {},
   "outputs": [],
   "source": [
    "#50,000 change to 50000\n",
    "csv_new['salary'] = csv_new[csv_new['salary'].str.contains('\\d',na = False)]['salary'].str.replace(',','',regex = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 620,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['salary'] = csv_new[csv_new['salary'].str.contains('\\d',na = False)]['salary'].str.replace('\\d\\%','',regex = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 621,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "12                                    $20 per hour\n",
       "17                           $20 - $24.99 per hour\n",
       "23                              $19 - $22 per hour\n",
       "25                           $20 - $24.99 per hour\n",
       "36                           $20 - $24.99 per hour\n",
       "42                                 $40000 - $49999\n",
       "48                                    $25 per hour\n",
       "58                     $60 000 - $70 000 per annum\n",
       "59                                 $20.00 per hour\n",
       "66                           $20 - $24.99 per hour\n",
       "75                                 $55000 - $69999\n",
       "77                                $20.00 per hour.\n",
       "78                           $20 - $24.99 per hour\n",
       "81                                    $21 per hour\n",
       "82                                 $55000 - $64999\n",
       "89                   $50000 - $55000 plus benefits\n",
       "97                                 $45000 - $49999\n",
       "103             $55000 - $60000 per annum pro rata\n",
       "112                          $20 - $24.99 per hour\n",
       "114                          $20 - $24.99 per hour\n",
       "123                                $48835 - $63221\n",
       "134                          $20 - $29.99 per hour\n",
       "148                                        $24-$28\n",
       "156                                     Up - $27ph\n",
       "165                  $50000 - $55000 plus benefits\n",
       "171                          $20 - $29.99 per hour\n",
       "173                          $20 - $29.99 per hour\n",
       "191                          $20 - $24.99 per hour\n",
       "212                                $55000 - $64999\n",
       "214                                $40000 - $49999\n",
       "219                                $45000 - $59999\n",
       "231                         NZD25 - NZD28 per hour\n",
       "247                          $20 - $24.99 per hour\n",
       "264                                $45000 - $49999\n",
       "277                                   $22 per hour\n",
       "278                             NZD75000 per annum\n",
       "282                          $20 - $24.99 per hour\n",
       "306                           $75000 - $85000 p.a.\n",
       "311                      $24 - $25 +  holiday pay!\n",
       "318                                $40000 - $49999\n",
       "319                              $50000 per annum.\n",
       "346                                $55000 - $64999\n",
       "349                             $20 - $25 per hour\n",
       "379                          $20 - $24.99 per hour\n",
       "384                  $30 - $38 p.h. +  Holiday Pay\n",
       "393                                     $45-$55000\n",
       "398                                $50000 - $54999\n",
       "403                 Up - $23 p.h. + +  Holiday Pay\n",
       "405                               Up - $22.00 p.h.\n",
       "430    NZD69726-94127p.a.+Retirement contributions\n",
       "Name: salary, dtype: object"
      ]
     },
     "execution_count": 621,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new[csv_new['salary'].str.contains('\\d',na = False)]['salary'].head(50)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 622,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2612"
      ]
     },
     "execution_count": 622,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new['salary'].isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 623,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['salary'] = csv_new['salary'].fillna('unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 624,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 624,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new['salary'].isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 625,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new[['low_salary','high_salary']] = csv_new['salary'].str.split('-',n = 1, expand = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 626,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "      <th>classification1</th>\n",
       "      <th>classification2</th>\n",
       "      <th>classification3</th>\n",
       "      <th>post_time</th>\n",
       "      <th>feature_at</th>\n",
       "      <th>low_salary</th>\n",
       "      <th>high_salary</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Office Management</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>Private Advertiser</td>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>Receptionists</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>Other</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-4</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>Administrative Assistants</td>\n",
       "      <td>Invercargill</td>\n",
       "      <td>Southland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Client &amp; Sales Administration</td>\n",
       "      <td>Christchurch</td>\n",
       "      <td>Canterbury</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-4</td>\n",
       "      <td>Private Advertiser</td>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>603</td>\n",
       "      <td>Workshop Administrator - Wellington</td>\n",
       "      <td>https://www.seek.co.nz/job/50495625?type=stand...</td>\n",
       "      <td>Fulton Hogan</td>\n",
       "      <td>Administrative Assistants</td>\n",
       "      <td>Hutt Valley</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-26</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>604</td>\n",
       "      <td>Service Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50504634?type=stand...</td>\n",
       "      <td>Sime Darby Motors Group</td>\n",
       "      <td>Other</td>\n",
       "      <td>Manukau &amp; East Auckland</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-25</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>605</td>\n",
       "      <td>Office Manager or Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50516673?type=stand...</td>\n",
       "      <td>Nice Energy Group Limited</td>\n",
       "      <td>Office Management</td>\n",
       "      <td>Auckland Central</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-22</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>606</td>\n",
       "      <td>Export Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50528019?type=stand...</td>\n",
       "      <td>PGG Wrightson Seeds</td>\n",
       "      <td>Contracts Administration</td>\n",
       "      <td>Rest of Canterbury</td>\n",
       "      <td>Canterbury</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-20</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>607</td>\n",
       "      <td>Practicum Placement Coordinator - Medical Prog...</td>\n",
       "      <td>https://www.seek.co.nz/job/50534474?type=stand...</td>\n",
       "      <td>The University of Auckland</td>\n",
       "      <td>Administrative Assistants</td>\n",
       "      <td>Auckland Central</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-19</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>608 rows × 14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                                                  role  \\\n",
       "0                                        Administrator   \n",
       "1                                         Receptionist   \n",
       "2                         Prosecutions Support Officer   \n",
       "3                 Early Childhood Centre Administrator   \n",
       "4                       Business Support Administrator   \n",
       "..                                                 ...   \n",
       "603                Workshop Administrator - Wellington   \n",
       "604                              Service Administrator   \n",
       "605                        Office Manager or Assistant   \n",
       "606                               Export Administrator   \n",
       "607  Practicum Placement Coordinator - Medical Prog...   \n",
       "\n",
       "                                          website_link  \\\n",
       "0    https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1    https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2    https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3    https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4    https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "..                                                 ...   \n",
       "603  https://www.seek.co.nz/job/50495625?type=stand...   \n",
       "604  https://www.seek.co.nz/job/50504634?type=stand...   \n",
       "605  https://www.seek.co.nz/job/50516673?type=stand...   \n",
       "606  https://www.seek.co.nz/job/50528019?type=stand...   \n",
       "607  https://www.seek.co.nz/job/50534474?type=stand...   \n",
       "\n",
       "                                      company                 classification  \\\n",
       "0                                     unknown              Office Management   \n",
       "1                        Avenues Orthodontics                  Receptionists   \n",
       "2                          New Zealand Police                          Other   \n",
       "3    Kew Pacific Island Early Learning Centre      Administrative Assistants   \n",
       "4                                     unknown  Client & Sales Administration   \n",
       "..                                        ...                            ...   \n",
       "603                              Fulton Hogan      Administrative Assistants   \n",
       "604                   Sime Darby Motors Group                          Other   \n",
       "605                 Nice Energy Group Limited              Office Management   \n",
       "606                       PGG Wrightson Seeds       Contracts Administration   \n",
       "607                The University of Auckland      Administrative Assistants   \n",
       "\n",
       "                    location           area   salary  classification1  \\\n",
       "0                   Tauranga  Bay of Plenty  unknown   Administration   \n",
       "1                   Tauranga  Bay of Plenty  unknown   Administration   \n",
       "2                    unknown       Auckland  unknown   Administration   \n",
       "3               Invercargill      Southland  unknown   Administration   \n",
       "4               Christchurch     Canterbury  unknown   Administration   \n",
       "..                       ...            ...      ...              ...   \n",
       "603              Hutt Valley     Wellington  unknown   Administration   \n",
       "604  Manukau & East Auckland       Auckland  unknown   Administration   \n",
       "605         Auckland Central       Auckland  unknown   Administration   \n",
       "606       Rest of Canterbury     Canterbury  unknown   Administration   \n",
       "607         Auckland Central       Auckland  unknown   Administration   \n",
       "\n",
       "                  classification2 classification3  post_time  \\\n",
       "0    Office SupportAdministration  Office Support          0   \n",
       "1    Office SupportAdministration  Office Support          0   \n",
       "2    Office SupportAdministration  Office Support         -4   \n",
       "3    Office SupportAdministration  Office Support          0   \n",
       "4    Office SupportAdministration  Office Support         -4   \n",
       "..                            ...             ...        ...   \n",
       "603  Office SupportAdministration  Office Support        -26   \n",
       "604  Office SupportAdministration  Office Support        -25   \n",
       "605  Office SupportAdministration  Office Support        -22   \n",
       "606  Office SupportAdministration  Office Support        -20   \n",
       "607  Office SupportAdministration  Office Support        -19   \n",
       "\n",
       "             feature_at low_salary high_salary  \n",
       "0    Private Advertiser    unknown        None  \n",
       "1               unknown    unknown        None  \n",
       "2               unknown    unknown        None  \n",
       "3               unknown    unknown        None  \n",
       "4    Private Advertiser    unknown        None  \n",
       "..                  ...        ...         ...  \n",
       "603             unknown    unknown        None  \n",
       "604             unknown    unknown        None  \n",
       "605             unknown    unknown        None  \n",
       "606             unknown    unknown        None  \n",
       "607             unknown    unknown        None  \n",
       "\n",
       "[608 rows x 14 columns]"
      ]
     },
     "execution_count": 626,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.head(608)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 627,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new[['low_salary','high_salary']]=csv_new[['low_salary','high_salary']].fillna('unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 628,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "17                      $24.99 per hour\n",
       "23                         $22 per hour\n",
       "25                      $24.99 per hour\n",
       "36                      $24.99 per hour\n",
       "42                               $49999\n",
       "                     ...               \n",
       "679      $55000 depending on experience\n",
       "682            $28 p.h.  +  Holiday Pay\n",
       "683           $40 p.h. + +  Holiday Pay\n",
       "1936           $28 p.h.  +  Holiday Pay\n",
       "1937          $40 p.h. + +  Holiday Pay\n",
       "Name: high_salary, Length: 83, dtype: object"
      ]
     },
     "execution_count": 628,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new[csv_new['high_salary'].str.contains('\\d',na= False)]['high_salary']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 629,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>salary</th>\n",
       "      <th>low_salary</th>\n",
       "      <th>high_salary</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>12</td>\n",
       "      <td>$20 per hour</td>\n",
       "      <td>$20 per hour</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>17</td>\n",
       "      <td>$20 - $24.99 per hour</td>\n",
       "      <td>$20</td>\n",
       "      <td>$24.99 per hour</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>23</td>\n",
       "      <td>$19 - $22 per hour</td>\n",
       "      <td>$19</td>\n",
       "      <td>$22 per hour</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>25</td>\n",
       "      <td>$20 - $24.99 per hour</td>\n",
       "      <td>$20</td>\n",
       "      <td>$24.99 per hour</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>36</td>\n",
       "      <td>$20 - $24.99 per hour</td>\n",
       "      <td>$20</td>\n",
       "      <td>$24.99 per hour</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>683</td>\n",
       "      <td>$35 - $40 p.h. + +  Holiday Pay</td>\n",
       "      <td>$35</td>\n",
       "      <td>$40 p.h. + +  Holiday Pay</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>695</td>\n",
       "      <td>Circa 50000</td>\n",
       "      <td>Circa 50000</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1936</td>\n",
       "      <td>$24 - $28 p.h.  +  Holiday Pay</td>\n",
       "      <td>$24</td>\n",
       "      <td>$28 p.h.  +  Holiday Pay</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1937</td>\n",
       "      <td>$35 - $40 p.h. + +  Holiday Pay</td>\n",
       "      <td>$35</td>\n",
       "      <td>$40 p.h. + +  Holiday Pay</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1949</td>\n",
       "      <td>Circa 50000</td>\n",
       "      <td>Circa 50000</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>95 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                               salary    low_salary  \\\n",
       "12                       $20 per hour  $20 per hour   \n",
       "17              $20 - $24.99 per hour          $20    \n",
       "23                 $19 - $22 per hour          $19    \n",
       "25              $20 - $24.99 per hour          $20    \n",
       "36              $20 - $24.99 per hour          $20    \n",
       "...                               ...           ...   \n",
       "683   $35 - $40 p.h. + +  Holiday Pay          $35    \n",
       "695                       Circa 50000   Circa 50000   \n",
       "1936   $24 - $28 p.h.  +  Holiday Pay          $24    \n",
       "1937  $35 - $40 p.h. + +  Holiday Pay          $35    \n",
       "1949                      Circa 50000   Circa 50000   \n",
       "\n",
       "                     high_salary  \n",
       "12                       unknown  \n",
       "17               $24.99 per hour  \n",
       "23                  $22 per hour  \n",
       "25               $24.99 per hour  \n",
       "36               $24.99 per hour  \n",
       "...                          ...  \n",
       "683    $40 p.h. + +  Holiday Pay  \n",
       "695                      unknown  \n",
       "1936    $28 p.h.  +  Holiday Pay  \n",
       "1937   $40 p.h. + +  Holiday Pay  \n",
       "1949                     unknown  \n",
       "\n",
       "[95 rows x 3 columns]"
      ]
     },
     "execution_count": 629,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new[csv_new['salary'].str.contains('\\d+',na= False)][['salary','low_salary','high_salary']]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## extract low_salary and high_salary column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 630,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['low_salary'] = csv_new['low_salary'].str.extract(r'(\\d+\\.\\d+|\\d+ \\d+|\\d+)',expand = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 631,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['high_salary'] = csv_new['high_salary'].str.extract(r'(\\d+\\.\\d+|\\d+ \\d+|\\d+)',expand = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 632,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "42       40000\n",
       "58      60 000\n",
       "59       20.00\n",
       "75       55000\n",
       "77       20.00\n",
       "82       55000\n",
       "89       50000\n",
       "97       45000\n",
       "103      55000\n",
       "123      48835\n",
       "165      50000\n",
       "212      55000\n",
       "214      40000\n",
       "219      45000\n",
       "264      45000\n",
       "278      75000\n",
       "306      75000\n",
       "318      40000\n",
       "319      50000\n",
       "346      55000\n",
       "398      50000\n",
       "430      69726\n",
       "442      60000\n",
       "444      22.00\n",
       "455      40000\n",
       "482      55000\n",
       "532      60000\n",
       "533      40000\n",
       "546      60000\n",
       "558      50000\n",
       "569      18.50\n",
       "575       25.5\n",
       "612      50000\n",
       "625      50000\n",
       "632      50000\n",
       "641      48000\n",
       "644      50000\n",
       "656      45000\n",
       "660      55000\n",
       "679      45000\n",
       "695      50000\n",
       "1949     50000\n",
       "Name: low_salary, dtype: object"
      ]
     },
     "execution_count": 632,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new[csv_new['low_salary'].str.contains('\\d+.\\d+',na =False)]['low_salary']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 633,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "17      24.99\n",
       "25      24.99\n",
       "36      24.99\n",
       "42      49999\n",
       "58     70 000\n",
       "66      24.99\n",
       "75      69999\n",
       "78      24.99\n",
       "82      64999\n",
       "89      55000\n",
       "97      49999\n",
       "103     60000\n",
       "112     24.99\n",
       "114     24.99\n",
       "123     63221\n",
       "134     29.99\n",
       "165     55000\n",
       "171     29.99\n",
       "173     29.99\n",
       "191     24.99\n",
       "212     64999\n",
       "214     49999\n",
       "219     59999\n",
       "247     24.99\n",
       "264     49999\n",
       "282     24.99\n",
       "306     85000\n",
       "318     49999\n",
       "346     64999\n",
       "379     24.99\n",
       "393     55000\n",
       "398     54999\n",
       "405     22.00\n",
       "430     94127\n",
       "442     70000\n",
       "444     23.00\n",
       "455     49999\n",
       "473     65000\n",
       "478     39.99\n",
       "482     64999\n",
       "494     24.99\n",
       "517     24.99\n",
       "533     49999\n",
       "546     69999\n",
       "558     59999\n",
       "569     23.50\n",
       "590     29.99\n",
       "612     69999\n",
       "625     59999\n",
       "629     29.99\n",
       "632     64999\n",
       "641     55000\n",
       "644     65000\n",
       "650     80000\n",
       "656     54999\n",
       "660     65000\n",
       "663     75000\n",
       "679     55000\n",
       "Name: high_salary, dtype: object"
      ]
     },
     "execution_count": 633,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new[csv_new['high_salary'].str.contains('\\d+.\\d+',na =False)]['high_salary']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 634,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['low_salary'] = csv_new[csv_new['low_salary'].str.contains('\\d',na= False)]['low_salary'].str.replace(' ','',regex = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 635,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['high_salary'] = csv_new[csv_new['high_salary'].str.contains('\\d',na= False)]['high_salary'].str.replace(' ','',regex = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 636,
   "metadata": {},
   "outputs": [],
   "source": [
    "#csv_new['low_salary'] = csv_new['low_salary'].fillna('unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 637,
   "metadata": {},
   "outputs": [],
   "source": [
    "#csv_new['high_salary'] = csv_new['high_salary'].fillna('unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 638,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "17     24.99\n",
       "25     24.99\n",
       "36     24.99\n",
       "42     49999\n",
       "58     70000\n",
       "66     24.99\n",
       "75     69999\n",
       "78     24.99\n",
       "82     64999\n",
       "89     55000\n",
       "97     49999\n",
       "103    60000\n",
       "112    24.99\n",
       "114    24.99\n",
       "123    63221\n",
       "134    29.99\n",
       "165    55000\n",
       "171    29.99\n",
       "173    29.99\n",
       "191    24.99\n",
       "212    64999\n",
       "214    49999\n",
       "219    59999\n",
       "247    24.99\n",
       "264    49999\n",
       "282    24.99\n",
       "306    85000\n",
       "318    49999\n",
       "346    64999\n",
       "379    24.99\n",
       "393    55000\n",
       "398    54999\n",
       "405    22.00\n",
       "430    94127\n",
       "442    70000\n",
       "444    23.00\n",
       "455    49999\n",
       "473    65000\n",
       "478    39.99\n",
       "482    64999\n",
       "494    24.99\n",
       "517    24.99\n",
       "533    49999\n",
       "546    69999\n",
       "558    59999\n",
       "569    23.50\n",
       "590    29.99\n",
       "612    69999\n",
       "625    59999\n",
       "629    29.99\n",
       "632    64999\n",
       "641    55000\n",
       "644    65000\n",
       "650    80000\n",
       "656    54999\n",
       "660    65000\n",
       "663    75000\n",
       "679    55000\n",
       "Name: high_salary, dtype: object"
      ]
     },
     "execution_count": 638,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new[csv_new['high_salary'].str.contains('\\d+.\\d+',na =False)]['high_salary']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 639,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "12        20\n",
       "17        20\n",
       "23        19\n",
       "25        20\n",
       "36        20\n",
       "42     40000\n",
       "48        25\n",
       "58     60000\n",
       "59     20.00\n",
       "66        20\n",
       "75     55000\n",
       "77     20.00\n",
       "78        20\n",
       "81        21\n",
       "82     55000\n",
       "89     50000\n",
       "97     45000\n",
       "103    55000\n",
       "112       20\n",
       "114       20\n",
       "123    48835\n",
       "134       20\n",
       "148       24\n",
       "156      NaN\n",
       "165    50000\n",
       "171       20\n",
       "173       20\n",
       "191       20\n",
       "212    55000\n",
       "214    40000\n",
       "219    45000\n",
       "231       25\n",
       "247       20\n",
       "264    45000\n",
       "277       22\n",
       "278    75000\n",
       "282       20\n",
       "306    75000\n",
       "311       24\n",
       "318    40000\n",
       "319    50000\n",
       "346    55000\n",
       "349       20\n",
       "379       20\n",
       "384       30\n",
       "393       45\n",
       "398    50000\n",
       "403      NaN\n",
       "405      NaN\n",
       "430    69726\n",
       "Name: low_salary, dtype: object"
      ]
     },
     "execution_count": 639,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new[csv_new['salary'].str.contains('\\d',na = False)]['low_salary'].head(50)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 640,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>high_salary</th>\n",
       "      <th>low_salary</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>5</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>6</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>7</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>8</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>9</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>10</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>11</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>12</td>\n",
       "      <td>NaN</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>13</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>14</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>15</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>16</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>17</td>\n",
       "      <td>24.99</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>18</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>19</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>20</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>21</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>22</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>23</td>\n",
       "      <td>22</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>24</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>25</td>\n",
       "      <td>24.99</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>26</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>27</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>28</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>29</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>30</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>31</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>32</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>33</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>34</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>35</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>36</td>\n",
       "      <td>24.99</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>37</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>38</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>39</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>40</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>41</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>42</td>\n",
       "      <td>49999</td>\n",
       "      <td>40000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>43</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>44</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>45</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>46</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>47</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>48</td>\n",
       "      <td>NaN</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>49</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   high_salary low_salary\n",
       "0          NaN        NaN\n",
       "1          NaN        NaN\n",
       "2          NaN        NaN\n",
       "3          NaN        NaN\n",
       "4          NaN        NaN\n",
       "5          NaN        NaN\n",
       "6          NaN        NaN\n",
       "7          NaN        NaN\n",
       "8          NaN        NaN\n",
       "9          NaN        NaN\n",
       "10         NaN        NaN\n",
       "11         NaN        NaN\n",
       "12         NaN         20\n",
       "13         NaN        NaN\n",
       "14         NaN        NaN\n",
       "15         NaN        NaN\n",
       "16         NaN        NaN\n",
       "17       24.99         20\n",
       "18         NaN        NaN\n",
       "19         NaN        NaN\n",
       "20         NaN        NaN\n",
       "21         NaN        NaN\n",
       "22         NaN        NaN\n",
       "23          22         19\n",
       "24         NaN        NaN\n",
       "25       24.99         20\n",
       "26         NaN        NaN\n",
       "27         NaN        NaN\n",
       "28         NaN        NaN\n",
       "29         NaN        NaN\n",
       "30         NaN        NaN\n",
       "31         NaN        NaN\n",
       "32         NaN        NaN\n",
       "33         NaN        NaN\n",
       "34         NaN        NaN\n",
       "35         NaN        NaN\n",
       "36       24.99         20\n",
       "37         NaN        NaN\n",
       "38         NaN        NaN\n",
       "39         NaN        NaN\n",
       "40         NaN        NaN\n",
       "41         NaN        NaN\n",
       "42       49999      40000\n",
       "43         NaN        NaN\n",
       "44         NaN        NaN\n",
       "45         NaN        NaN\n",
       "46         NaN        NaN\n",
       "47         NaN        NaN\n",
       "48         NaN         25\n",
       "49         NaN        NaN"
      ]
     },
     "execution_count": 640,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new[['high_salary','low_salary']].head(50)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 641,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new.loc[csv_new['low_salary']=='unknown','low_salary'] = csv_new['high_salary']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 642,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new.loc[csv_new['high_salary']=='unknown','high_salary'] = csv_new['low_salary']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 643,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "      <th>classification1</th>\n",
       "      <th>classification2</th>\n",
       "      <th>classification3</th>\n",
       "      <th>post_time</th>\n",
       "      <th>feature_at</th>\n",
       "      <th>low_salary</th>\n",
       "      <th>high_salary</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Office Management</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>Private Advertiser</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>Receptionists</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>Other</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-4</td>\n",
       "      <td>unknown</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>Administrative Assistants</td>\n",
       "      <td>Invercargill</td>\n",
       "      <td>Southland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Client &amp; Sales Administration</td>\n",
       "      <td>Christchurch</td>\n",
       "      <td>Canterbury</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-4</td>\n",
       "      <td>Private Advertiser</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   role  \\\n",
       "0                         Administrator   \n",
       "1                          Receptionist   \n",
       "2          Prosecutions Support Officer   \n",
       "3  Early Childhood Centre Administrator   \n",
       "4        Business Support Administrator   \n",
       "\n",
       "                                        website_link  \\\n",
       "0  https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1  https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2  https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3  https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4  https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "\n",
       "                                    company                 classification  \\\n",
       "0                                   unknown              Office Management   \n",
       "1                      Avenues Orthodontics                  Receptionists   \n",
       "2                        New Zealand Police                          Other   \n",
       "3  Kew Pacific Island Early Learning Centre      Administrative Assistants   \n",
       "4                                   unknown  Client & Sales Administration   \n",
       "\n",
       "       location           area   salary  classification1  \\\n",
       "0      Tauranga  Bay of Plenty  unknown   Administration   \n",
       "1      Tauranga  Bay of Plenty  unknown   Administration   \n",
       "2       unknown       Auckland  unknown   Administration   \n",
       "3  Invercargill      Southland  unknown   Administration   \n",
       "4  Christchurch     Canterbury  unknown   Administration   \n",
       "\n",
       "                classification2 classification3  post_time  \\\n",
       "0  Office SupportAdministration  Office Support          0   \n",
       "1  Office SupportAdministration  Office Support          0   \n",
       "2  Office SupportAdministration  Office Support         -4   \n",
       "3  Office SupportAdministration  Office Support          0   \n",
       "4  Office SupportAdministration  Office Support         -4   \n",
       "\n",
       "           feature_at low_salary high_salary  \n",
       "0  Private Advertiser        NaN         NaN  \n",
       "1             unknown        NaN         NaN  \n",
       "2             unknown        NaN         NaN  \n",
       "3             unknown        NaN         NaN  \n",
       "4  Private Advertiser        NaN         NaN  "
      ]
     },
     "execution_count": 643,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 644,
   "metadata": {},
   "outputs": [],
   "source": [
    "# change type\n",
    "csv_new['low_salary'] = csv_new['low_salary'].astype('float32')\n",
    "csv_new['high_salary'] = csv_new['high_salary'].astype('float32')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 645,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new.loc[csv_new['low_salary'] < 50, 'low_salary'] = csv_new['low_salary'] * 8*200"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 646,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new.loc[csv_new['high_salary'] < 50, 'high_salary'] = csv_new['high_salary'] * 8*200"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 647,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['low_salary']=csv_new['low_salary'].fillna('unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 648,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['high_salary']=csv_new['high_salary'].fillna('unknown')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 659,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "      <th>classification1</th>\n",
       "      <th>classification2</th>\n",
       "      <th>classification3</th>\n",
       "      <th>post_time</th>\n",
       "      <th>feature_at</th>\n",
       "      <th>low_salary</th>\n",
       "      <th>high_salary</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Office Management</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>Private Advertiser</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>Receptionists</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>Other</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-4</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>Administrative Assistants</td>\n",
       "      <td>Invercargill</td>\n",
       "      <td>Southland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Client &amp; Sales Administration</td>\n",
       "      <td>Christchurch</td>\n",
       "      <td>Canterbury</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-4</td>\n",
       "      <td>Private Advertiser</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   role  \\\n",
       "0                         Administrator   \n",
       "1                          Receptionist   \n",
       "2          Prosecutions Support Officer   \n",
       "3  Early Childhood Centre Administrator   \n",
       "4        Business Support Administrator   \n",
       "\n",
       "                                        website_link  \\\n",
       "0  https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1  https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2  https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3  https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4  https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "\n",
       "                                    company                 classification  \\\n",
       "0                                   unknown              Office Management   \n",
       "1                      Avenues Orthodontics                  Receptionists   \n",
       "2                        New Zealand Police                          Other   \n",
       "3  Kew Pacific Island Early Learning Centre      Administrative Assistants   \n",
       "4                                   unknown  Client & Sales Administration   \n",
       "\n",
       "       location           area   salary  classification1  \\\n",
       "0      Tauranga  Bay of Plenty  unknown   Administration   \n",
       "1      Tauranga  Bay of Plenty  unknown   Administration   \n",
       "2       unknown       Auckland  unknown   Administration   \n",
       "3  Invercargill      Southland  unknown   Administration   \n",
       "4  Christchurch     Canterbury  unknown   Administration   \n",
       "\n",
       "                classification2 classification3  post_time  \\\n",
       "0  Office SupportAdministration  Office Support          0   \n",
       "1  Office SupportAdministration  Office Support          0   \n",
       "2  Office SupportAdministration  Office Support         -4   \n",
       "3  Office SupportAdministration  Office Support          0   \n",
       "4  Office SupportAdministration  Office Support         -4   \n",
       "\n",
       "           feature_at low_salary high_salary  \n",
       "0  Private Advertiser    unknown     unknown  \n",
       "1             unknown    unknown     unknown  \n",
       "2             unknown    unknown     unknown  \n",
       "3             unknown    unknown     unknown  \n",
       "4  Private Advertiser    unknown     unknown  "
      ]
     },
     "execution_count": 659,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 655,
   "metadata": {},
   "outputs": [],
   "source": [
    "def classification1(x):\n",
    "    if x == '':\n",
    "        return 'unknown'\n",
    "    else:\n",
    "        return x "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 656,
   "metadata": {},
   "outputs": [],
   "source": [
    "csv_new['classification1'] = csv_new['classification1'].apply(classification1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 658,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "      <th>classification1</th>\n",
       "      <th>classification2</th>\n",
       "      <th>classification3</th>\n",
       "      <th>post_time</th>\n",
       "      <th>feature_at</th>\n",
       "      <th>low_salary</th>\n",
       "      <th>high_salary</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>2703</td>\n",
       "      <td>Key Account Manager</td>\n",
       "      <td>https://www.seek.co.nz/job/50490062?type=stand...</td>\n",
       "      <td>Hays Talent Solutions</td>\n",
       "      <td>Client &amp; Sales Administration</td>\n",
       "      <td>Auckland Central</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-27</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2704</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50488000?type=stand...</td>\n",
       "      <td>one eighty recruitment</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Wellington Central</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>-27</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2705</td>\n",
       "      <td>Temporary Office Roles</td>\n",
       "      <td>https://www.seek.co.nz/job/50524865?type=stand...</td>\n",
       "      <td>Asset Recruitment Ltd</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Hamilton</td>\n",
       "      <td>Waikato</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>-20</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2706</td>\n",
       "      <td>Temporary Office Roles</td>\n",
       "      <td>https://www.seek.co.nz/job/50477118?type=stand...</td>\n",
       "      <td>Asset Recruitment Ltd</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Hamilton</td>\n",
       "      <td>Waikato</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>-28</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2707</td>\n",
       "      <td>Executive Assistant</td>\n",
       "      <td>https://www.seek.co.nz/job/50496571?type=stand...</td>\n",
       "      <td>Alpha Recruitment - NZ</td>\n",
       "      <td>PA, EA &amp; Secretarial</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Wellington</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-26</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "      <td>unknown</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        role  \\\n",
       "2703     Key Account Manager   \n",
       "2704     Executive Assistant   \n",
       "2705  Temporary Office Roles   \n",
       "2706  Temporary Office Roles   \n",
       "2707     Executive Assistant   \n",
       "\n",
       "                                           website_link  \\\n",
       "2703  https://www.seek.co.nz/job/50490062?type=stand...   \n",
       "2704  https://www.seek.co.nz/job/50488000?type=stand...   \n",
       "2705  https://www.seek.co.nz/job/50524865?type=stand...   \n",
       "2706  https://www.seek.co.nz/job/50477118?type=stand...   \n",
       "2707  https://www.seek.co.nz/job/50496571?type=stand...   \n",
       "\n",
       "                     company                 classification  \\\n",
       "2703   Hays Talent Solutions  Client & Sales Administration   \n",
       "2704  one eighty recruitment                        unknown   \n",
       "2705   Asset Recruitment Ltd                        unknown   \n",
       "2706   Asset Recruitment Ltd                        unknown   \n",
       "2707  Alpha Recruitment - NZ           PA, EA & Secretarial   \n",
       "\n",
       "                location        area   salary  classification1  \\\n",
       "2703    Auckland Central    Auckland  unknown   Administration   \n",
       "2704  Wellington Central  Wellington  unknown          unknown   \n",
       "2705            Hamilton     Waikato  unknown          unknown   \n",
       "2706            Hamilton     Waikato  unknown          unknown   \n",
       "2707             unknown  Wellington  unknown   Administration   \n",
       "\n",
       "                   classification2 classification3  post_time feature_at  \\\n",
       "2703  Office SupportAdministration  Office Support        -27    unknown   \n",
       "2704                       unknown         unknown        -27    unknown   \n",
       "2705                       unknown         unknown        -20    unknown   \n",
       "2706                       unknown         unknown        -28    unknown   \n",
       "2707  Office SupportAdministration  Office Support        -26    unknown   \n",
       "\n",
       "     low_salary high_salary  \n",
       "2703    unknown     unknown  \n",
       "2704    unknown     unknown  \n",
       "2705    unknown     unknown  \n",
       "2706    unknown     unknown  \n",
       "2707    unknown     unknown  "
      ]
     },
     "execution_count": 658,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.tail()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 660,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       unknown\n",
       "1       unknown\n",
       "2       unknown\n",
       "3       unknown\n",
       "4       unknown\n",
       "         ...   \n",
       "2703    unknown\n",
       "2704    unknown\n",
       "2705    unknown\n",
       "2706    unknown\n",
       "2707    unknown\n",
       "Name: high_salary, Length: 2708, dtype: object"
      ]
     },
     "execution_count": 660,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new['high_salary']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 667,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([57789])"
      ]
     },
     "execution_count": 667,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import numpy as np\n",
    "#salary between $45000 and $75000 that is check on the website\n",
    "# do a range of the salary which between 45000 and 75000\n",
    "np.random.randint(45000,75000,size = 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 665,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/wangzhuoxin/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:3: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  This is separate from the ipykernel package so we can avoid doing imports until\n"
     ]
    }
   ],
   "source": [
    "for index, row in enumerate(csv_new['low_salary'].values):\n",
    "    if row == \"unknown\":\n",
    "        csv_new['low_salary'][index] = np.random.randint(45000, 75000,size = 1 )[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 668,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/wangzhuoxin/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:3: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  This is separate from the ipykernel package so we can avoid doing imports until\n"
     ]
    }
   ],
   "source": [
    "for index, row in enumerate(csv_new['high_salary'].values):\n",
    "    if row == \"unknown\":\n",
    "        csv_new['high_salary'][index] = np.random.randint(45000, 75000,size = 1 )[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 669,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>role</th>\n",
       "      <th>website_link</th>\n",
       "      <th>company</th>\n",
       "      <th>classification</th>\n",
       "      <th>location</th>\n",
       "      <th>area</th>\n",
       "      <th>salary</th>\n",
       "      <th>classification1</th>\n",
       "      <th>classification2</th>\n",
       "      <th>classification3</th>\n",
       "      <th>post_time</th>\n",
       "      <th>feature_at</th>\n",
       "      <th>low_salary</th>\n",
       "      <th>high_salary</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50582301?type=promo...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Office Management</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>Private Advertiser</td>\n",
       "      <td>66403</td>\n",
       "      <td>53793</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>Receptionist</td>\n",
       "      <td>https://www.seek.co.nz/job/50620889?type=promo...</td>\n",
       "      <td>Avenues Orthodontics</td>\n",
       "      <td>Receptionists</td>\n",
       "      <td>Tauranga</td>\n",
       "      <td>Bay of Plenty</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "      <td>56396</td>\n",
       "      <td>56475</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>Prosecutions Support Officer</td>\n",
       "      <td>https://www.seek.co.nz/job/50622169?type=stand...</td>\n",
       "      <td>New Zealand Police</td>\n",
       "      <td>Other</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Auckland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-4</td>\n",
       "      <td>unknown</td>\n",
       "      <td>49309</td>\n",
       "      <td>71692</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>Early Childhood Centre Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50639620?type=stand...</td>\n",
       "      <td>Kew Pacific Island Early Learning Centre</td>\n",
       "      <td>Administrative Assistants</td>\n",
       "      <td>Invercargill</td>\n",
       "      <td>Southland</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>0</td>\n",
       "      <td>unknown</td>\n",
       "      <td>50461</td>\n",
       "      <td>49058</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>Business Support Administrator</td>\n",
       "      <td>https://www.seek.co.nz/job/50622432?type=stand...</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Client &amp; Sales Administration</td>\n",
       "      <td>Christchurch</td>\n",
       "      <td>Canterbury</td>\n",
       "      <td>unknown</td>\n",
       "      <td>Administration</td>\n",
       "      <td>Office SupportAdministration</td>\n",
       "      <td>Office Support</td>\n",
       "      <td>-4</td>\n",
       "      <td>Private Advertiser</td>\n",
       "      <td>62652</td>\n",
       "      <td>73771</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                   role  \\\n",
       "0                         Administrator   \n",
       "1                          Receptionist   \n",
       "2          Prosecutions Support Officer   \n",
       "3  Early Childhood Centre Administrator   \n",
       "4        Business Support Administrator   \n",
       "\n",
       "                                        website_link  \\\n",
       "0  https://www.seek.co.nz/job/50582301?type=promo...   \n",
       "1  https://www.seek.co.nz/job/50620889?type=promo...   \n",
       "2  https://www.seek.co.nz/job/50622169?type=stand...   \n",
       "3  https://www.seek.co.nz/job/50639620?type=stand...   \n",
       "4  https://www.seek.co.nz/job/50622432?type=stand...   \n",
       "\n",
       "                                    company                 classification  \\\n",
       "0                                   unknown              Office Management   \n",
       "1                      Avenues Orthodontics                  Receptionists   \n",
       "2                        New Zealand Police                          Other   \n",
       "3  Kew Pacific Island Early Learning Centre      Administrative Assistants   \n",
       "4                                   unknown  Client & Sales Administration   \n",
       "\n",
       "       location           area   salary  classification1  \\\n",
       "0      Tauranga  Bay of Plenty  unknown   Administration   \n",
       "1      Tauranga  Bay of Plenty  unknown   Administration   \n",
       "2       unknown       Auckland  unknown   Administration   \n",
       "3  Invercargill      Southland  unknown   Administration   \n",
       "4  Christchurch     Canterbury  unknown   Administration   \n",
       "\n",
       "                classification2 classification3  post_time  \\\n",
       "0  Office SupportAdministration  Office Support          0   \n",
       "1  Office SupportAdministration  Office Support          0   \n",
       "2  Office SupportAdministration  Office Support         -4   \n",
       "3  Office SupportAdministration  Office Support          0   \n",
       "4  Office SupportAdministration  Office Support         -4   \n",
       "\n",
       "           feature_at low_salary high_salary  \n",
       "0  Private Advertiser      66403       53793  \n",
       "1             unknown      56396       56475  \n",
       "2             unknown      49309       71692  \n",
       "3             unknown      50461       49058  \n",
       "4  Private Advertiser      62652       73771  "
      ]
     },
     "execution_count": 669,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "csv_new.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
